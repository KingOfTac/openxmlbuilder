{"version":3,"file":"OpenXmlBuilder.min.js","sources":["OpenXmlBuilder.js"],"names":["window","undefined","nsResolver","pref","ox","nameNS","name","rootNs","r","full","ns","oxNs","toks","split","length","use","docTemplate","t","xmlDoctype","arguments","i","openXmlISOString","date","pad2","number","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","nodeWrap","nodes","push","XNode","node","this","XDoc","xmlStr","charCodeAt","substring","doc","xhelp","makeDoc","root","getAttr","XPart","xpkg","contentType","path","relsXmlStr","idx","lastIndexOf","relsPath","slice","xdoc","relsXdoc","f","zip","file","asText","XPkg","b64Template","title","created","creator","JSZip","base64","checkCRC32","parts","Date","ctDoc","core","getPart","one","setValue","titleElement","add","el","leftPad","s","len","c","convertColor","tem","toString","toUpperCase","test","A","substr","colornames","match","indexOf","Math","round","parseFloat","parseInt","join","convertStyle","a","verticalAlign","sup","sub","fontWeight","isNaN","b","fontStyle","textDecoration","u","color","backgroundColor","bgColor","Blocker","blocks","block","cleanupHtml","html","replace","convertHtml","d","document","createElement","p","head","body","appendChild","innerHTML","mblocker","procNodes","childNodes","removeChild","getBlocks","PPTXContentWriter","slide","txBody","ps","all","j","remove","listStack","listItem","PPTXBuilder","call","presentation","sldIdLst","slideCount","app","slidesProp","slidesTitlesProp","titlesVector","removeAllSlides","slideLayouts","_findLayouts","_valBuild","e","v","w:val","DOCXBuilder","sectPr","es","rStyles","pStyles","Italic","rStyleItalic","Bold","rStyleBold","Underline","rStyleUnderline","styles","styleType","styleId","undoPart","OpenXmlBuilder","version","xmlns","rel","vt","dcterms","dc","cp","ep","w","ct","selNs","abbrev","hasOwnProperty","relTypes","relTypePrefix","hyperlink","contTypes","relsTemplate","EGHelper","DOMParser","parseFromString","makeEl","tag","createElementNS","toXml","XMLSerializer","serializeToString","xpath","first","ownerDocument","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","rs","ORDERED_NODE_SNAPSHOT_TYPE","snapshotLength","snapshotItem","setNs","setAttributeNS","IEHelper","ActiveXObject","async","loadXML","setProperty","createNode","xml","selectSingleNode","selectNodes","value","setAttributeNode","XMLHelper","prototype","parentNode","nodeType","firstChild","txt","createTextNode","getValue","nodeValue","setAttr","attr","setAttribute","getAttribute","removeAttr","removeAttribute","before","insertBefore","replacement","documentElement","nextId","ids","setNamespace","toXmlString","nextRelationshipId","addRelationship","rId","type","target","mode","Target","Type","Id","TargetMode","deleteRelationship","apply","getRelationshipsByRelationshipType","rtype","loadXml","strXml","override","part","addPart","addFile","data","cts","ContentType","PartName","deleteFile","fullPath","relPath","ctxPath","slashIndex","saveChanges","deleted","saveToBase64","generate","compression","saveToBlob","saveToDataURI","mimetype","getStyle","getComputedStyle","currentStyle","AQUA","BLACK","BLUE","FUCHSIA","GRAY","GREEN","LIME","MAROON","NAVY","OLIVE","PURPLE","RED","SILVER","TEAL","WHITE","YELLOW","addRun","style","text","run","currentBlock","runs","breakBlock","force","procNode","child","sblocker","cssStyle","display","isBlock","cstyle","tagName","listType","toLowerCase","link","href","hr","alt","src","children","slideMaster","slideLayout","unshift","shift","inlineTable","paragraph","parent","rPr","lastLink","val","r:id","indent","level","pPr","table","cind","cspan","rspan","row","cell","colspans","spanned","colspan","rowspan","addSlide","slideNum","sldId","slideUri","template","relUri","id","contentSlide","content","shapes","spId","pptTable","pptContent","rels","relationshipId","slideLayoutObjects","folder","slo","layoutXmlName","slideLayoutId","fullUri","masterPath","layoutSections","sld","layoutName","ph","phType","hf","sldTemplate","index","fileName","sections","_table","k","tbl","phTxbody","phTc","writer","shape","pptLine","graphicFrame","numbering","aFChunk","rStyleHyperlink","pStyleNoSpacing","pStyleListParagraph","pStyle","rStyle","_levelIndent","makeUl","makeList","fmt","fnt","makeOl","makeOlNum","makeOlHier","hier","levels","depth","numPart","nsid","random","anumid","listid","anum","lvl","lvlText","hLvlText","idt","heir","w:hanging","w:left","w:hint","w:hAnsi","w:ascii","num","docLine","seg","_paragraph","docContent","listTracker","item","_blocks","docChunk","uri","chunk","_block","pPrs","_runs","define","amd","module","exports"],"mappings":"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","sourcesContent":["/*!\r\n * OpenXmlBuilder\r\n * The OpenXmlBuilder allows you to build simple OpenXml documents right in the browser.\r\n * Copyright (c) 2015 Jeremy Gore\r\n * Licensed MIT\r\n * https://github.com/jmgore75/openxmlbuilder\r\n * v0.1.1\r\n */\n(function(window, undefined) {\n  \"use strict\";\n  var OpenXmlBuilder = {};\n  OpenXmlBuilder.version = \"0.1.1\";\n  var ox = {};\n  ox.xmlns = \"http://www.w3.org/2000/xmlns/\";\n  ox.rel = \"http://schemas.openxmlformats.org/package/2006/relationships\";\n  ox.a = \"http://schemas.openxmlformats.org/drawingml/2006/main\";\n  ox.p = \"http://schemas.openxmlformats.org/presentationml/2006/main\";\n  ox.r = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\";\n  ox.vt = \"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\";\n  ox.dcterms = \"http://purl.org/dc/terms/\";\n  ox.dc = \"http://purl.org/dc/elements/1.1/\";\n  ox.cp = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\n  ox.ep = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\n  ox.w = \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\";\n  ox.ct = \"http://schemas.openxmlformats.org/package/2006/content-types\";\n  var oxNs = {};\n  var selNs = \"\";\n  (function() {\n    for (var abbrev in ox) {\n      if (ox.hasOwnProperty(abbrev)) {\n        oxNs[ox[abbrev]] = abbrev;\n        if (abbrev === \"xmlns\") {\n          selNs += \" xmlns='\" + ox[abbrev] + \"'\";\n        } else {\n          selNs += \" xmlns:\" + abbrev + \"='\" + ox[abbrev] + \"'\";\n        }\n      }\n    }\n  })();\n  selNs = selNs.slice(1);\n  function nsResolver(pref) {\n    return ox[pref] || null;\n  }\n  function nameNS(name, rootNs) {\n    var r = {\n      full: name,\n      name: name,\n      ns: rootNs\n    };\n    r.pref = oxNs[rootNs] || \"\";\n    var toks = name.split(\":\");\n    if (toks.length === 2) {\n      r.pref = toks[0];\n      r.name = toks[1];\n      r.ns = ox[r.pref] || null;\n    }\n    r.use = r.ns === rootNs ? r.name : r.full;\n    return r;\n  }\n  var relTypes = {};\n  var relTypePrefix = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/\";\n  relTypes.hyperlink = relTypePrefix + \"hyperlink\";\n  var contTypes = {};\n  var xmlDoctype = '<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>';\n  function docTemplate() {\n    var t = xmlDoctype;\n    t += \"<\" + arguments[0];\n    if (arguments.length > 1 && arguments[1]) {\n      t += \" xmlns='\" + ox[arguments[1]] + \"'\";\n    }\n    for (var i = 2; i < arguments.length; i++) {\n      t += \" xmlns:\" + arguments[i] + \"='\" + ox[arguments[i]] + \"'\";\n    }\n    t += \"></\" + arguments[0] + \">\";\n    return t;\n  }\n  var relsTemplate = docTemplate(\"Relationships\", \"rel\");\n  var EGHelper = {\n    makeDoc: function(xmlStr) {\n      return new DOMParser().parseFromString(xmlStr, \"text/xml\");\n    },\n    makeEl: function(doc, tag, rootNs) {\n      var r = nameNS(tag, rootNs);\n      return doc.createElementNS(r.ns || null, r.use);\n    },\n    toXml: function(doc) {\n      return new XMLSerializer().serializeToString(doc);\n    },\n    xpath: function(node, xpath, first) {\n      var doc = node.ownerDocument || node;\n      if (first) {\n        return doc.evaluate(xpath, node, nsResolver, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n      } else {\n        var rs = [];\n        var r = doc.evaluate(xpath, node, nsResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n        for (var i = 0; i < r.snapshotLength; i++) {\n          rs.push(r.snapshotItem(i));\n        }\n        return rs;\n      }\n    },\n    setNs: function(node, ns, abbrev) {\n      node.setAttributeNS(ox.xmlns, abbrev ? \"xmlns:\" + abbrev : \"xmlns\", ns);\n    }\n  };\n  var IEHelper = {\n    makeDoc: function(xmlStr) {\n      var doc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n      doc.async = \"false\";\n      doc.loadXML(xmlStr);\n      doc.setProperty(\"SelectionNamespaces\", selNs);\n      return doc;\n    },\n    makeEl: function(doc, tag, rootNs) {\n      var r = nameNS(tag, rootNs);\n      return doc.createNode(1, r.use, r.ns || null);\n    },\n    toXml: function(doc) {\n      return doc.xml;\n    },\n    xpath: function(node, xpath, first) {\n      if (first) {\n        return node.selectSingleNode(xpath);\n      } else {\n        return node.selectNodes(xpath);\n      }\n    },\n    setNs: function(node, ns, abbrev) {\n      var a = node.doc.createNode(2, abbrev ? \"xmlns:\" + abbrev : \"xmlns\", ox.xmlns);\n      a.value = ns;\n      node.setAttributeNode(a);\n    }\n  };\n  var xhelp = window.ActiveXObject ? IEHelper : EGHelper;\n  OpenXmlBuilder.XMLHelper = xhelp;\n  function openXmlISOString(date) {\n    function pad2(number) {\n      if (number < 10) {\n        return \"0\" + number;\n      }\n      return number;\n    }\n    return date.getUTCFullYear() + \"-\" + pad2(date.getUTCMonth() + 1) + \"-\" + pad2(date.getUTCDate()) + \"T\" + pad2(date.getUTCHours()) + \":\" + pad2(date.getUTCMinutes()) + \":\" + pad2(date.getUTCSeconds()) + \"Z\";\n  }\n  function nodeWrap(nodes) {\n    var r = [];\n    for (var i = 0; i < nodes.length; i++) {\n      r.push(new XNode(nodes[i]));\n    }\n    return r;\n  }\n  function XNode(node) {\n    this.node = node;\n  }\n  XNode.prototype = {\n    all: function(path) {\n      return nodeWrap(xhelp.xpath(this.node, path, false));\n    },\n    one: function(path) {\n      var node = xhelp.xpath(this.node, path, true);\n      return node ? new XNode(node) : null;\n    },\n    remove: function() {\n      this.node.parentNode.removeChild(this.node);\n    },\n    setValue: function(value) {\n      if (this.node.nodeType === 1) {\n        while (this.node.firstChild) {\n          this.node.removeChild(this.node.firstChild);\n        }\n        var txt = this.node.ownerDocument.createTextNode(value);\n        this.node.appendChild(txt);\n      } else if (this.node.nodeType === 2) {\n        this.value = value;\n      }\n      return this;\n    },\n    getValue: function() {\n      if (this.node.nodeType === 2) {\n        return this.value;\n      } else {\n        return this.node.nodeValue;\n      }\n    },\n    setAttr: function(attr, value) {\n      this.node.setAttribute(attr, value);\n      return this;\n    },\n    getAttr: function(attr) {\n      return this.node.getAttribute(attr);\n    },\n    removeAttr: function(attr) {\n      this.node.removeAttribute(attr);\n      return this;\n    },\n    add: function(el, before) {\n      if (before) {\n        this.node.insertBefore(el.node, before.node);\n      } else {\n        this.node.appendChild(el.node);\n      }\n      return this;\n    },\n    replace: function(replacement) {\n      this.node.insertBefore(replacement.node);\n      this.remove();\n      return replacement;\n    }\n  };\n  function XDoc(xmlStr) {\n    if (xmlStr.charCodeAt(0) === 65279) {\n      xmlStr = xmlStr.substring(1);\n    }\n    this.doc = xhelp.makeDoc(xmlStr);\n    this.rootNs = this.root().getAttr(\"xmlns\");\n  }\n  XDoc.prototype = {\n    el: function(tag, attr, value) {\n      var el = new XNode(xhelp.makeEl(this.doc, tag, this.rootNs));\n      if (!value && attr && typeof attr !== \"object\") {\n        value = attr;\n        attr = null;\n      }\n      if (attr) {\n        for (var a in attr) {\n          if (attr.hasOwnProperty(a)) {\n            el.setAttr(a, attr[a]);\n          }\n        }\n      }\n      if (value) {\n        el.setValue(value);\n      }\n      return el;\n    },\n    root: function() {\n      return new XNode(this.doc.documentElement);\n    },\n    all: function(path) {\n      return nodeWrap(xhelp.xpath(this.doc, path, false));\n    },\n    one: function(path) {\n      var node = xhelp.xpath(this.doc, path, true);\n      return node ? new XNode(node) : null;\n    },\n    nextId: function(path, attr, first, pref) {\n      first = first || 0;\n      pref = pref || \"\";\n      var ids = {};\n      var es = this.all(path);\n      for (var i = 0; i < es.length; i++) {\n        ids[es[i].getAttr(attr)] = 1;\n      }\n      while (ids[pref + first]) {\n        first += 1;\n      }\n      return pref + first;\n    },\n    setNamespace: function(ns, abbrev) {\n      xhelp.setNs(this.root(), ns, abbrev);\n      if (!abbrev) {\n        this.rootNs = ns;\n      }\n    },\n    toXmlString: function() {\n      return xhelp.toXml(this.doc);\n    }\n  };\n  function XPart(xpkg, contentType, path, xmlStr, relsXmlStr) {\n    this.xpkg = xpkg;\n    this.path = path;\n    this.contentType = contentType;\n    var idx = path.lastIndexOf(\"/\") + 1;\n    this.relsPath = path.slice(0, idx) + \"_rels/\" + path.slice(idx) + \".rels\";\n    if (xmlStr) {\n      this.xdoc = new XDoc(xmlStr);\n      if (relsXmlStr) {\n        this.relsXdoc = new XDoc(relsXmlStr);\n      }\n    } else {\n      var f = this.xpkg.zip.file(this.path.slice(1));\n      if (f) {\n        this.xdoc = new XDoc(f.asText());\n        f = this.xpkg.zip.file(this.relsPath.slice(1));\n        if (f) {\n          this.relsXdoc = new XDoc(f.asText());\n        }\n      }\n    }\n  }\n  XPart.prototype = {\n    nextRelationshipId: function() {\n      if (!this.relsXdoc) {\n        return \"rId1\";\n      }\n      return this.relsXdoc.nextId(\"/rel:Relationships/rel:Relationship\", \"Id\", 1, \"rId\");\n    },\n    addRelationship: function(rId, type, target, mode) {\n      if (!this.relsXdoc) {\n        this.relsXdoc = new XDoc(relsTemplate);\n      }\n      var attr = {\n        Target: target,\n        Type: type,\n        Id: rId\n      };\n      mode = mode || \"External\";\n      if (mode !== \"Internal\") {\n        attr.TargetMode = mode;\n      }\n      var e = this.relsXdoc.el(\"rel:Relationship\", attr);\n      this.relsXdoc.root().add(e);\n    },\n    deleteRelationship: function(rId) {\n      if (this.relsXdoc) {\n        var es = this.relsXdoc.all(\"/rel:Relationships/rel:Relationship\");\n        for (var i = 0; i < es.length; i++) {\n          if (es[i].getAttr(\"Id\") === rId) {\n            es[i].remove();\n            if (es.length === 1) {\n              delete this.relsXdoc;\n            }\n            return;\n          }\n        }\n      }\n    },\n    el: function() {\n      return this.xdoc.el.apply(this.xdoc, arguments);\n    },\n    root: function() {\n      return this.xdoc.root();\n    },\n    all: function() {\n      return this.xdoc.all.apply(this.xdoc, arguments);\n    },\n    one: function() {\n      return this.xdoc.one.apply(this.xdoc, arguments);\n    },\n    nextId: function() {\n      return this.xdoc.nextId.apply(this.xdoc, arguments);\n    },\n    setNamespace: function() {\n      return this.xdoc.setNamespace.apply(this.xdoc, arguments);\n    },\n    getRelationshipsByRelationshipType: function(rtype) {\n      return this.relsXdoc.all(\"/rel:Relationships/rel:Relationship[@Type='\" + rtype + \"']\");\n    },\n    loadXml: function(strXml) {\n      this.xdoc = new XDoc(strXml);\n    }\n  };\n  function XPkg(b64Template, title, created, creator) {\n    this.zip = new JSZip(b64Template, {\n      base64: true,\n      checkCRC32: false\n    });\n    this.parts = {};\n    created = created || new Date();\n    created = openXmlISOString(created);\n    title = title || \"Document \" + created;\n    creator = creator || \"OpenXmlBuilder\";\n    this.ctDoc = new XDoc(this.zip.file(\"[Content_Types].xml\").asText());\n    var core = this.getPart(\"/docProps/core.xml\").xdoc;\n    core.one(\"//dcterms:created\").setValue(created);\n    core.one(\"//dcterms:modified\").setValue(created);\n    core.one(\"//cp:revision\").setValue(\"1\");\n    if (title) {\n      var titleElement = core.one(\"//dc:title\");\n      if (titleElement) {\n        titleElement.setValue(title);\n      } else {\n        core.root().add(core.el(\"dc:title\", title));\n      }\n    }\n    core.one(\"//dc:creator\").setValue(creator);\n    core.one(\"//cp:lastModifiedBy\").setValue(creator);\n  }\n  XPkg.prototype = {\n    getPart: function(path) {\n      if (this.parts.hasOwnProperty(path)) {\n        return this.parts[path];\n      } else {\n        var override = this.ctDoc.one(\"/ct:Types/ct:Override[@PartName='\" + path + \"']\");\n        var part = override ? new XPart(this, override.getAttr(\"ContentType\"), path) : null;\n        this.parts[path] = part;\n        return part;\n      }\n    },\n    addPart: function(contentType, path, xmlStr, relsXmlStr) {\n      var part = new XPart(this, contentType, path, xmlStr, relsXmlStr);\n      this.parts[path] = part;\n      return part;\n    },\n    addFile: function(ct, path, data) {\n      this.zip.file(path.slice(1), data);\n      var cts = this.ctDoc.all(\"/ct:Types/ct:Override\");\n      for (var i = 0; i < cts.length; i++) {\n        if (cts[i].getAttr(\"PartName\") === path) {\n          cts[i].remove();\n        }\n      }\n      var e = this.ctDoc.el(\"ct:Override\", {\n        ContentType: ct,\n        PartName: path\n      });\n      this.ctDoc.root().add(e);\n    },\n    deleteFile: function(path) {\n      this.zip.remove(path);\n      var cts = this.ctDoc.all(\"/ct:Types/ct:Override\");\n      for (var i = 0; i < cts.length; i++) {\n        if (cts[i].getAttr(\"PartName\") === path) {\n          cts[i].remove();\n        }\n      }\n    },\n    fullPath: function(relPath, ctxPath) {\n      if (relPath.indexOf(\"/\") === 0) {\n        return relPath;\n      }\n      ctxPath = ctxPath || \"/\";\n      var slashIndex = ctxPath.lastIndexOf(\"/\");\n      ctxPath = ctxPath.slice(0, slashIndex + 1);\n      while (relPath.indexOf(\"../\") === 0) {\n        ctxPath = ctxPath.slice(0, ctxPath.length - 1);\n        slashIndex = ctxPath.lastIndexOf(\"/\");\n        if (slashIndex === -1) {\n          throw \"internal error when processing relationships\";\n        }\n        ctxPath = ctxPath.slice(0, slashIndex + 1);\n        relPath = relPath.slice(3);\n      }\n      return ctxPath + relPath;\n    },\n    undoPart: function(path) {\n      delete this.parts[path];\n    },\n    saveChanges: function() {\n      var part;\n      for (var path in this.parts) {\n        if (this.parts.hasOwnProperty(path)) {\n          part = this.parts[path];\n          if (part.deleted || !part.xdoc) {\n            this.deleteFile(part.path);\n            this.zip.remove(part.relsPath);\n          } else {\n            this.addFile(part.contentType, part.path, part.xdoc.toXmlString());\n            if (part.relsXdoc) {\n              this.zip.file(part.relsPath.slice(1), part.relsXdoc.toXmlString());\n            } else {\n              this.zip.remove(part.relsPath);\n            }\n          }\n        }\n      }\n      this.parts = {};\n      this.zip.file(\"[Content_Types].xml\", this.ctDoc.toXmlString());\n      return this.zip;\n    },\n    saveToBase64: function() {\n      return this.saveChanges().generate({\n        compression: \"deflate\",\n        type: \"base64\"\n      });\n    },\n    saveToBlob: function() {\n      return this.saveChanges().generate({\n        compression: \"deflate\",\n        type: \"blob\"\n      });\n    },\n    saveToDataURI: function() {\n      return \"data:\" + this.mimetype + \";base64,\" + this.saveToBase64();\n    }\n  };\n  var getStyle = window.getComputedStyle || function(e) {\n    return e.currentStyle;\n  };\n  function leftPad(s, len, c) {\n    c = c || \" \";\n    len = len || 2;\n    while (s.length < len) {\n      s = c + s;\n    }\n    return s;\n  }\n  var colornames = {\n    AQUA: \"00FFFF\",\n    BLACK: \"000000\",\n    BLUE: \"0000FF\",\n    FUCHSIA: \"FF00FF\",\n    GRAY: \"808080\",\n    GREEN: \"008000\",\n    LIME: \"00FF00\",\n    MAROON: \"800000\",\n    NAVY: \"000080\",\n    OLIVE: \"808000\",\n    PURPLE: \"800080\",\n    RED: \"FF0000\",\n    SILVER: \"C0C0C0\",\n    TEAL: \"008080\",\n    WHITE: \"FFFFFF\",\n    YELLOW: \"FFFF00\"\n  };\n  function convertColor(c) {\n    var tem, i = 0;\n    c = c ? c.toString().toUpperCase() : \"\";\n    if (/^#[A-F0-9]{3,6}$/.test(c)) {\n      if (c.length < 7) {\n        var A = c.split(\"\");\n        c = A[1] + A[1] + A[2] + A[2] + A[3] + A[3];\n      } else {\n        c = c.substr(1, 8);\n      }\n      return c;\n    }\n    if (/^[A-Z]+$/.test(c)) {\n      return colornames[c] || \"\";\n    }\n    c = c.match(/\\d+(\\.\\d+)?%?/g) || [];\n    if (c.length < 3 || c.length > 4) {\n      return \"\";\n    }\n    for (i = 0; i < c.length; i++) {\n      tem = c[i];\n      if (tem.indexOf(\"%\") !== -1) {\n        tem = Math.round(parseFloat(tem) * 2.55);\n      } else {\n        tem = parseInt(tem, 10);\n      }\n      if (tem < 0 || tem > 255) {\n        return \"\";\n      } else {\n        c[i] = leftPad(tem.toString(16).toUpperCase(), 2, \"0\");\n      }\n    }\n    if (c.length === 4 && c[3] === \"00\") {\n      return \"\";\n    }\n    return c.slice(0, 3).join(\"\");\n  }\n  function convertStyle(s) {\n    var a = {};\n    if (s.verticalAlign === \"super\") {\n      a.sup = 1;\n    }\n    if (s.verticalAlign === \"sub\") {\n      a.sub = 1;\n    }\n    var i = parseInt(s.fontWeight, 10);\n    if (isNaN(i)) {\n      if (s.fontWeight === \"bold\") {\n        a.b = 1;\n      }\n    } else {\n      if (i >= 700) {\n        a.b = 1;\n      }\n    }\n    if (s.fontStyle === \"italic\") {\n      a.i = 1;\n    }\n    if (s.textDecoration === \"underline\") {\n      a.u = 1;\n    }\n    var color = convertColor(s.color);\n    if (color && color !== \"000000\") {\n      a.color = color;\n    }\n    color = convertColor(s.backgroundColor);\n    if (color && color !== \"FFFFFF\") {\n      a.bgColor = color;\n    }\n    return a;\n  }\n  function Blocker() {\n    this.blocks = [];\n    this.block = null;\n  }\n  Blocker.prototype = {\n    addRun: function(style, text) {\n      var run = {};\n      for (var attr in style) {\n        if (style.hasOwnProperty(attr)) {\n          run[attr] = style[attr];\n        }\n      }\n      run.text = text;\n      var block = this.currentBlock();\n      block.runs.push(run);\n      return run;\n    },\n    currentBlock: function() {\n      if (!this.block) {\n        this.block = {\n          type: \"paragraph\",\n          runs: []\n        };\n      }\n      return this.block;\n    },\n    breakBlock: function(force) {\n      if (this.block || force) {\n        var block = this.currentBlock();\n        this.blocks.push(block);\n        this.block = null;\n        return block;\n      } else if (this.blocks.length) {\n        return this.blocks[this.blocks.length - 1];\n      }\n    },\n    getBlocks: function() {\n      this.breakBlock();\n      return this.blocks;\n    },\n    procNode: function(style, child) {\n      var sblocker;\n      if (child.nodeType === 3) {\n        this.addRun(style, child.nodeValue);\n      } else if (child.nodeType === 1) {\n        var cssStyle = getStyle(child);\n        if (cssStyle.display === \"none\") {\n          return;\n        }\n        var isBlock = cssStyle.display === \"block\";\n        var cstyle = convertStyle(cssStyle);\n        if (isBlock) {\n          this.breakBlock();\n        }\n        if (child.tagName === \"LI\") {\n          this.breakBlock();\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"list-item\",\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"OL\" || child.tagName === \"UL\") {\n          this.breakBlock();\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"list\",\n            listType: child.tagName.toLowerCase(),\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"TABLE\") {\n          this.breakBlock();\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table\",\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"TR\") {\n          this.breakBlock();\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table-row\",\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"TD\" || child.tagName === \"TH\") {\n          this.breakBlock();\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table-cell\",\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"A\") {\n          cstyle.link = child.href;\n          this.procNodes(cstyle, child.childNodes);\n        } else if (child.tagName === \"HR\") {\n          this.currentBlock().hr = true;\n          this.breakBlock();\n        } else if (child.tagName === \"BR\") {\n          this.breakBlock();\n        } else if (child.tagName === \"IMG\") {\n          var run = this.addRun(cstyle, \"[\" + (child.alt || child.title || \"IMAGE\") + \"]\");\n          run.link = child.src;\n        } else {\n          this.procNodes(cstyle, child.childNodes);\n        }\n      }\n    },\n    procNodes: function(style, children) {\n      for (var i = 0; i < children.length; i++) {\n        this.procNode(style, children[i]);\n      }\n    }\n  };\n  function cleanupHtml(html) {\n    if (html) {\n      return html.replace(/[\\u200B-\\u200D\\uFEFF]/g, \"\").replace(/\\s+/g, \" \");\n    }\n  }\n  function convertHtml(html) {\n    var d = document.createElement(\"DIV\");\n    var p = document.head || document.body;\n    p.appendChild(d);\n    d.innerHTML = cleanupHtml(html);\n    var mblocker = new Blocker();\n    mblocker.procNodes({}, d.childNodes);\n    p.removeChild(d);\n    d = null;\n    return mblocker.getBlocks();\n  }\n  OpenXmlBuilder.convertHtml = convertHtml;\n  relTypes.slideMaster = relTypePrefix + \"slideMaster\";\n  relTypes.slideLayout = relTypePrefix + \"slideLayout\";\n  relTypes.slide = relTypePrefix + \"slide\";\n  contTypes.slide = \"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\";\n  function PPTXContentWriter(slide, txBody) {\n    this.slide = slide;\n    this.txBody = txBody;\n    var ps = this.txBody.all(\"./a:p\");\n    for (var j = 0; j < ps.length; j++) {\n      ps[j].remove();\n    }\n    this.listStack = [];\n    this.listItem = false;\n  }\n  PPTXContentWriter.prototype = {\n    block: function(block) {\n      if (block.type === \"list\") {\n        this.listStack.unshift(block.listType || \"ul\");\n        this.blocks(block.blocks);\n        this.listStack.shift();\n      } else if (block.type === \"table\") {\n        this.inlineTable(block);\n      } else if (block.type === \"list-item\") {\n        this.listItem = true;\n        this.blocks(block.blocks);\n        this.listItem = false;\n      } else {\n        this.paragraph(block);\n      }\n    },\n    blocks: function(blocks) {\n      for (var i = 0; i < blocks.length; i++) {\n        this.block(blocks[i]);\n      }\n    },\n    runs: function(parent, runs) {\n      var run, r, rPr, t, rId;\n      var lastLink;\n      for (var i = 0; i < runs.length; i++) {\n        run = runs[i];\n        r = this.slide.el(\"a:r\");\n        lastLink = run.link;\n        if (run.b || run.i || run.u || run.color || run.link) {\n          rPr = this.slide.el(\"a:rPr\");\n          if (run.b) {\n            rPr.setAttr(\"b\", \"1\");\n          }\n          if (run.i) {\n            rPr.setAttr(\"i\", \"1\");\n          }\n          if (run.u) {\n            rPr.setAttr(\"u\", \"sng\");\n          }\n          if (run.color) {\n            rPr.add(this.slide.el(\"a:solidFill\").add(this.slide.el(\"a:srgbClr\", {\n              val: run.color\n            })));\n          }\n          if (run.link) {\n            rId = this.slide.nextRelationshipId();\n            this.slide.addRelationship(rId, relTypes.hyperlink, run.link, \"External\");\n            rPr.add(this.slide.el(\"a:hlinkClick\", {\n              \"r:id\": rId\n            }));\n          }\n          r.add(rPr);\n        }\n        t = this.slide.el(\"a:t\", run.text);\n        r.add(t);\n        parent.add(r);\n      }\n      if (lastLink) {\n        parent.add(this.slide.el(\"a:endParaRPr\").add(this.slide.el(\"a:hlinkClick\", {\n          \"r:id\": \"\"\n        })));\n      }\n    },\n    paragraph: function(paragraph, indent) {\n      var runs = paragraph.runs || [];\n      var level = this.listStack.length;\n      var listType;\n      if (indent || level) {\n        if (level > 0) {\n          if (this.listItem) {\n            listType = this.listStack[0];\n            if (!runs.length) {\n              runs = [ {\n                text: \" \"\n              } ];\n            }\n            this.listItem = false;\n          }\n        }\n        if (indent) {\n          level += indent;\n        }\n      }\n      var pPr = this.slide.el(\"a:pPr\");\n      if (level > 1) {\n        pPr.setAttr(\"lvl\", level - 1);\n      }\n      if (listType === \"ol\") {\n        pPr.add(this.slide.el(\"a:buAutoNum\", {\n          type: \"arabicPeriod\"\n        }));\n      } else if (!listType) {\n        pPr.add(this.slide.el(\"a:buNone\"));\n      }\n      var p = this.slide.el(\"a:p\");\n      p.add(pPr);\n      if (!listType && level > 0) {\n        p.add(this.slide.el(\"a:r\").add(this.slide.el(\"a:t\", \"\t\")));\n      }\n      this.runs(p, runs);\n      this.txBody.add(p);\n    },\n    inlineTable: function(table) {\n      var i, j, cind, cspan, rspan, row, cell;\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          cind += cspan;\n        }\n      };\n      this.paragraph({\n        runs: [ {\n          u: true,\n          i: true,\n          text: \"Table\"\n        } ]\n      });\n      this.listStack.unshift(\"ul\");\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        this.listItem = true;\n        this.paragraph({\n          runs: [ {\n            u: true,\n            i: true,\n            text: \"Row \" + (row + 1)\n          } ]\n        });\n        this.listStack.unshift(\"ul\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          cell = row.blocks[j];\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          this.listItem = true;\n          this.paragraph({\n            runs: [ {\n              i: true,\n              text: \"Column\" + (cind + 1)\n            } ]\n          });\n          this.blocks(cell);\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n          }\n          cind += cspan;\n        }\n        spanned();\n        this.listStack.shift();\n      }\n      this.listStack.shift();\n    }\n  };\n  function PPTXBuilder(b64Template, title, created, creator) {\n    XPkg.call(this, b64Template, title, created, creator);\n    this.presentation = this.getPart(\"/ppt/presentation.xml\");\n    this.sldIdLst = this.presentation.one(\"/p:presentation/p:sldIdLst\");\n    this.slideCount = this.sldIdLst.all(\"./p:sldId\").length;\n    this.app = this.getPart(\"/docProps/app.xml\").xdoc;\n    this.slidesProp = this.app.one(\"/ep:Properties/ep:Slides\");\n    this.slidesTitlesProp = this.app.all(\"/ep:Properties/ep:HeadingPairs/vt:vector/vt:variant/vt:i4\");\n    this.slidesTitlesProp = this.slidesTitlesProp[this.slidesTitlesProp.length - 1];\n    this.titlesVector = this.app.one(\"/ep:Properties/ep:TitlesOfParts/vt:vector\");\n    this.removeAllSlides();\n    this.slideLayouts = this._findLayouts();\n  }\n  PPTXBuilder.prototype = {\n    mimetype: \"application/vnd.openxmlformats-officedocument.presentationml.presentation\",\n    addSlide: function(title, slideLayout) {\n      slideLayout = slideLayout || this.slideLayouts[\"Title and Content\"];\n      this.slideCount++;\n      var slideNum = this.slideCount;\n      var sldId = slideNum + 255;\n      title = title || \"Slide \" + slideNum;\n      var slideUri = \"slides/slide\" + slideNum + \".xml\";\n      var slide = this.addPart(contTypes.slide, \"/ppt/\" + slideUri, slideLayout.template);\n      slide.addRelationship(slide.nextRelationshipId(), relTypes.slideLayout, slideLayout.relUri, \"Internal\");\n      var rId = this.presentation.nextRelationshipId();\n      this.presentation.addRelationship(rId, relTypes.slide, slideUri, \"Internal\");\n      this.sldIdLst.add(this.presentation.el(\"p:sldId\", {\n        \"r:id\": rId,\n        id: sldId\n      }));\n      this.slidesProp.setValue(slideNum);\n      this.slidesTitlesProp.setValue(slideNum);\n      this.titlesVector.add(this.app.el(\"vt:lpstr\", title));\n      this.titlesVector.setAttr(\"size\", slideNum + 1);\n      return slide;\n    },\n    contentSlide: function(content, slideLayout) {\n      var title = content.title || content[\"Title 1\"];\n      var slide = this.addSlide(title, slideLayout);\n      var shapes = slide.all(\"//p:sp\");\n      for (var i = 0; i < shapes.length; i++) {\n        var spId = shapes[i].one(\"./p:nvSpPr/p:cNvPr\").getAttr(\"name\");\n        var html = content[spId];\n        if (html) {\n          var blocks = convertHtml(html);\n          if (blocks.length === 1 && blocks[0].type === \"table\") {\n            this.pptTable(slide, shapes[i], blocks[0]);\n          } else {\n            this.pptContent(slide, shapes[i], blocks);\n          }\n        }\n      }\n    },\n    removeAllSlides: function() {\n      var rels = this.presentation.getRelationshipsByRelationshipType(relTypes.slide);\n      var rel, part;\n      for (var i = 0; i < rels.length; i++) {\n        rel = rels[i];\n        part = this.getPart(this.fullPath(rel.getAttr(\"Target\"), this.presentation.path));\n        this.presentation.deleteRelationship(rel.relationshipId);\n        part.deleted = true;\n      }\n      this.sldIdLst = this.presentation.one(\"/p:presentation/p:sldIdLst\");\n      var es = this.sldIdLst.all(\"./p:sldId\");\n      for (i = 0; i < es.length; i++) {\n        es[i].remove();\n      }\n      this.slidesProp.setValue(\"0\");\n      this.slidesTitlesProp.setValue(\"0\");\n      this.titlesVector.setAttr(\"size\", \"1\");\n      es = this.titlesVector.all(\"./vt:lpstr\");\n      for (i = 1; i < es.length; i++) {\n        es[i].remove();\n      }\n      this.slideCount = 0;\n    },\n    _findLayouts: function() {\n      var slideLayouts = {};\n      var slideLayoutObjects = this.zip.folder(\"ppt/slideLayouts\").file(/^slideLayout\\d+\\.xml$/);\n      for (var j = 0; j < slideLayoutObjects.length; j++) {\n        var slo = slideLayoutObjects[j];\n        var layoutXmlName = slo.name.slice(17);\n        var slideLayoutId = parseInt(layoutXmlName.slice(11, -4), 10);\n        var fullUri = \"/\" + slo.name;\n        var relUri = \"../slideLayouts/\" + layoutXmlName;\n        var slideLayout = new XDoc(slo.asText());\n        var masterPath = new XDoc(this.zip.file(\"ppt/slideLayouts/_rels/\" + layoutXmlName + \".rels\").asText()).one(\"/rel:Relationships/rel:Relationship[@Type='\" + relTypes.slideMaster + \"']\").getAttr(\"Target\");\n        var slideMaster = this.getPart(this.fullPath(masterPath, fullUri));\n        var layoutSections = [];\n        var sld = slideLayout.root();\n        sld.removeAttr(\"preserve\");\n        sld.removeAttr(\"type\");\n        var layoutName = sld.one(\"p:cSld\").getAttr(\"name\");\n        sld.one(\"p:cSld\").removeAttr(\"name\");\n        var hf = slideMaster.one(\"//p:hf\");\n        var shapes = sld.all(\"//p:sp\");\n        var ph, phType;\n        for (var i = 0; i < shapes.length; i++) {\n          if (hf) {\n            ph = shapes[i].one(\"./p:nvSpPr/p:nvPr/p:ph\");\n            if (ph) {\n              phType = ph.getAttr(\"type\");\n              if (phType && hf.getAttr(phType) === \"0\") {\n                shapes[i].remove();\n                continue;\n              }\n            }\n          }\n          var spId = shapes[i].one(\"./p:nvSpPr/p:cNvPr\").getAttr(\"name\");\n          if (spId) {\n            layoutSections.push(spId);\n          }\n        }\n        var sldTemplate = slideLayout.toXmlString();\n        sldTemplate = sldTemplate.replace(/(<\\/?p:sld)Layout/g, \"$1\");\n        slideLayouts[layoutName] = {\n          name: layoutName,\n          index: slideLayoutId,\n          fileName: layoutXmlName,\n          fullUri: fullUri,\n          relUri: relUri,\n          sections: layoutSections,\n          template: sldTemplate\n        };\n      }\n      return slideLayouts;\n    },\n    _table: function(slide, parent, table) {\n      var i, j, k, row, cell, r, c, e, cspan, rspan, cind;\n      var tbl = slide.el(\"a:tbl\");\n      var phTxbody = function() {\n        return slide.el(\"a:txBody\").add(slide.el(\"a:bodyPr\")).add(slide.el(\"a:lstStyle\"));\n      };\n      var phTc = function() {\n        return slide.el(\"a:tc\").add(phTxbody().add(slide.el(\"a:p\"))).add(slide.el(\"a:tcPr\"));\n      };\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          var c = phTc().setAttr(\"vMerge\", 1);\n          r.add(c);\n          if (cspan > 1) {\n            c.setAttr(\"gridSpan\", cspan);\n            for (k = 1; k < cspan; k++) {\n              r.add(phTc().setAttr(\"hMerge\", 1).setAttr(\"vMerge\", 1));\n            }\n          }\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          cind += cspan;\n        }\n      };\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        r = slide.el(\"a:tr\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          cell = row.blocks[j];\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          c = slide.el(\"a:tc\");\n          r.add(c);\n          if (cspan > 1) {\n            c.setAttr(\"gridSpan\", cspan);\n            for (k = 1; k < cspan; k++) {\n              r.add(phTc().setAttr(\"hMerge\", 1));\n            }\n          }\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n          }\n          e = phTxbody();\n          c.add(e);\n          var writer = new PPTXContentWriter(slide, e);\n          writer.blocks(cell.blocks);\n          e = slide.el(\"a:tcPr\");\n          c.add(e);\n          cind += cspan;\n        }\n        spanned();\n        tbl.add(r);\n      }\n      parent.add(tbl);\n    },\n    pptContent: function(slide, shape, blocks) {\n      var writer = new PPTXContentWriter(slide, shape.one(\"./p:txBody\"));\n      writer.blocks(blocks);\n    },\n    pptLine: function(slide, shape, block) {\n      var writer = new PPTXContentWriter(slide, shape.one(\"./p:txBody\"));\n      if (block.type === \"paragraph\") {\n        writer.paragraph(block);\n      } else {\n        throw \"Block is not a paragraph\";\n      }\n    },\n    pptTable: function(slide, shape, block) {\n      var graphicFrame = slide.el(\"p:graphicFrame\");\n      var a, b, c, i;\n      a = slide.el(\"p:nvGraphicFramePr\");\n      graphicFrame.add(a);\n      b = shape.one(\"./p:cNvPr\");\n      if (b) {\n        a.add(b);\n      }\n      b = shape.one(\"./p:cNvSpPr\");\n      if (b) {\n        c = slide.el(\"p:cNvGraphicFramePr\");\n        b = b.all(\"./*\");\n        for (i = 0; i < b.length; i++) {\n          c.add(b[i]);\n        }\n        a.add(c);\n      }\n      b = shape.one(\"./p:nvPr\");\n      if (b) {\n        b.add(b);\n      }\n      a = slide.el(\"a:graphic\");\n      graphicFrame.add(a);\n      b = slide.el(\"a:graphicData\").setAttr(\"uri\", \"http://schemas.openxmlformats.org/drawingml/2006/table\");\n      a.add(b);\n      shape.replace(graphicFrame);\n      if (block.type === \"table\") {\n        this._table(slide, b, block);\n      } else {\n        throw \"Block is not a table\";\n      }\n    }\n  };\n  (function() {\n    for (var f in XPkg.prototype) {\n      if (XPkg.prototype.hasOwnProperty(f)) {\n        PPTXBuilder.prototype[f] = XPkg.prototype[f];\n      }\n    }\n  })();\n  OpenXmlBuilder.PPTXBuilder = PPTXBuilder;\n  relTypes.numbering = relTypePrefix + \"numbering\";\n  relTypes.aFChunk = relTypePrefix + \"aFChunk\";\n  contTypes.numbering = \"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml\";\n  function _valBuild(e, v) {\n    return function(xdoc) {\n      return xdoc.el(e, {\n        \"w:val\": v\n      });\n    };\n  }\n  function DOCXBuilder(b64Template, title, created, creator) {\n    XPkg.call(this, b64Template, title, created, creator);\n    this.doc = this.getPart(\"/word/document.xml\");\n    this.body = this.doc.one(\"/w:document/w:body\");\n    this.sectPr = this.body.one(\"./w:sectPr\");\n    var es = this.body.all(\"./*\");\n    for (var i = 0; i < es.length; i++) {\n      es[i].remove();\n    }\n    if (this.sectPr) {\n      this.body.add(this.sectPr);\n    }\n    this.rStyles = {};\n    this.pStyles = {};\n    this.rStyles.Italic = this.rStyleItalic;\n    this.rStyles.Bold = this.rStyleBold;\n    this.rStyles.Underline = this.rStyleUnderline;\n    var styles = this.getPart(\"/word/styles.xml\").all(\"w:styles/w:style\");\n    for (i = 0; i < styles.length; i++) {\n      var styleType = styles[i].getAttr(\"w:type\");\n      var styleId = styles[i].getAttr(\"w:styleId\");\n      if (styleType === \"paragraph\") {\n        this.pStyles[styleId] = _valBuild(\"w:pStyle\", styleId);\n      } else if (styleType === \"character\") {\n        this.rStyles[styleId] = _valBuild(\"w:rStyle\", styleId);\n      }\n    }\n    this.undoPart(\"/word/styles.xml\");\n  }\n  DOCXBuilder.prototype = {\n    mimetype: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n    rStyleItalic: function(xdoc) {\n      return xdoc.el(\"w:i\");\n    },\n    rStyleBold: function(xdoc) {\n      return xdoc.el(\"w:b\");\n    },\n    rStyleUnderline: _valBuild(\"w:u\", \"single\"),\n    rStyleHyperlink: _valBuild(\"w:rStyle\", \"Hyperlink\"),\n    pStyleNoSpacing: _valBuild(\"w:pStyle\", \"NoSpacing\"),\n    pStyleListParagraph: _valBuild(\"w:pStyle\", \"ListParagraph\"),\n    pStyle: function(name) {\n      return this.pStyles[name] || _valBuild(\"w:pStyle\", name);\n    },\n    rStyle: function(name) {\n      return this.rStyles[name] || _valBuild(\"w:rStyle\", name);\n    },\n    _levelIndent: function(level) {\n      return 720 * (level || 0);\n    },\n    makeUl: function() {\n      return this.makeList([ {\n        fmt: \"bullet\",\n        fnt: \"Symbol\",\n        txt: \"·\"\n      }, {\n        fmt: \"bullet\",\n        fnt: \"Courier New\",\n        txt: \"o\"\n      }, {\n        fmt: \"bullet\",\n        fnt: \"Wingdings\",\n        txt: \"§\"\n      } ], 9);\n    },\n    makeOl: function() {\n      return this.makeList([ {\n        fmt: \"decimal\"\n      }, {\n        fmt: \"lowerLetter\"\n      }, {\n        fmt: \"lowerRoman\"\n      } ], 9);\n    },\n    makeOlNum: function() {\n      return this.makeList([ {\n        fmt: \"decimal\"\n      } ], 9);\n    },\n    makeOlHier: function() {\n      return this.makeList([ {\n        fmt: \"decimal\",\n        hier: true\n      } ], 9);\n    },\n    makeList: function(levels, depth) {\n      var numPart = this.getPart(\"/word/numbering.xml\");\n      if (!numPart) {\n        numPart = this.addPart(contTypes.numbering, \"/word/numbering.xml\", docTemplate(\"w:numbering\", null, \"w\"));\n        this.doc.addRelationship(this.doc.nextRelationshipId(), relTypes.numbering, \"numbering.xml\", \"Internal\");\n      }\n      var nsid = Math.random().toString(16).substring(2, 10).toUpperCase();\n      var anumid = numPart.nextId(\"//w:abstractNum\", \"w:abstractNumId\", 0);\n      var listid = numPart.nextId(\"//w:num\", \"w:numId\", 1);\n      var anum = numPart.el(\"w:abstractNum\").setAttr(\"w:abstractNumId\", anumid);\n      anum.add(numPart.el(\"w:nsid\").setAttr(\"w:val\", nsid));\n      anum.add(numPart.el(\"w:multiLevelType\").setAttr(\"w:val\", \"hybridMultilevel\"));\n      var lvl, level, lvlText, hLvlText, idt;\n      depth = depth || levels.length;\n      for (var i = 0; i < depth; i++) {\n        level = levels[i % levels.length];\n        idt = this._levelIndent(i + 1);\n        lvl = numPart.el(\"w:lvl\").setAttr(\"w:ilvl\", i);\n        lvl.add(numPart.el(\"w:start\").setAttr(\"w:val\", \"1\"));\n        lvl.add(numPart.el(\"w:numFmt\").setAttr(\"w:val\", level.fmt));\n        if (level.fmt === \"bullet\") {\n          lvlText = level.txt || \" \";\n          hLvlText = \"\";\n        } else {\n          lvlText = \"%\" + (i + 1) + \".\";\n          hLvlText += lvlText;\n        }\n        lvl.add(numPart.el(\"w:lvlText\").setAttr(\"w:val\", level.heir ? hLvlText : lvlText));\n        lvl.add(numPart.el(\"w:lvlJc\").setAttr(\"w:val\", \"left\"));\n        lvl.add(numPart.el(\"w:pPr\").add(numPart.el(\"w:ind\", {\n          \"w:hanging\": \"360\",\n          \"w:left\": idt\n        })));\n        if (level.fnt) {\n          lvl.add(numPart.el(\"w:rPr\").add(numPart.el(\"w:rFonts\", {\n            \"w:hint\": \"default\",\n            \"w:hAnsi\": level.fnt,\n            \"w:ascii\": level.fnt\n          })));\n        }\n        anum.add(lvl);\n      }\n      var num = numPart.el(\"w:num\").setAttr(\"w:numId\", listid);\n      num.add(numPart.el(\"w:abstractNumId\").setAttr(\"w:val\", anumid));\n      numPart.xdoc.root().add(anum);\n      numPart.xdoc.root().add(num);\n      return listid;\n    },\n    docLine: function(html, pStyle, rStyle) {\n      var seg = convertHtml(html);\n      if (seg.length === 1 && seg[0].type === \"paragraph\") {\n        seg = seg[0];\n        this._paragraph(this.body, this.sectPr, seg, pStyle, rStyle);\n      } else {\n        throw \"Content is too complex\";\n      }\n    },\n    docContent: function(html) {\n      var blocks = convertHtml(html);\n      var listTracker = {\n        id: undefined,\n        level: 0,\n        item: false\n      };\n      this._blocks(this.body, this.sectPr, blocks, listTracker);\n    },\n    docChunk: function(html) {\n      html = \"<html><head></head><body>\" + cleanupHtml(html) + \"</body></html>\";\n      var rId = this.doc.nextRelationshipId();\n      var uri = \"/word/chunk\" + rId + \".html\";\n      this.addFile(\"text/html\", uri, html);\n      this.doc.addRelationship(rId, relTypes.aFChunk, uri, \"Internal\");\n      var chunk = this.doc.el(\"w:altChunk\").setAttr(\"r:id\", rId);\n      this.body.add(chunk, this.sectPr);\n    },\n    _block: function(parent, before, block, listTracker) {\n      if (block.type === \"table\") {\n        if (listTracker.id && listTracker.item) {\n          this._block(parent, before, {\n            type: \"paragraph\",\n            runs: [ {\n              text: \"Table\",\n              i: true\n            } ]\n          }, listTracker);\n        }\n        this._table(parent, before, block);\n      } else if (block.type === \"list\") {\n        if (!listTracker.id) {\n          listTracker.id = block.listType === \"ul\" ? this.makeUl() : this.makeOlHier();\n        }\n        listTracker.level++;\n        this._blocks(parent, before, block.blocks, listTracker);\n        listTracker.level--;\n        if (!listTracker.level) {\n          listTracker.id = undefined;\n        }\n      } else if (block.type === \"list-item\") {\n        listTracker.item = true;\n        this._blocks(parent, before, block.blocks, listTracker);\n        listTracker.item = false;\n      } else if (listTracker.id) {\n        var pPrs;\n        if (listTracker.item) {\n          pPrs = this.doc.el(\"w:numPr\");\n          pPrs.add(_valBuild(\"w:ilvl\", listTracker.level - 1)(this.doc.xdoc));\n          pPrs.add(_valBuild(\"w:numId\", listTracker.id)(this.doc.xdoc));\n        } else {\n          pPrs = this.doc.el(\"w:ind\").setAttr(\"w:left\", this._levelIndent(listTracker.level));\n        }\n        this._paragraph(parent, before, block, this.pStyleListParagraph, null, pPrs);\n      } else {\n        this._paragraph(parent, before, block);\n      }\n    },\n    _blocks: function(parent, before, blocks, listTracker) {\n      for (var i = 0; i < blocks.length; i++) {\n        this.block(parent, before, blocks[i], listTracker);\n      }\n    },\n    _runs: function(parent, runs, rStyle) {\n      var run, r, rPr, t;\n      for (var i = 0; i < runs.length; i++) {\n        run = runs[i];\n        r = this.doc.el(\"w:r\");\n        if (run.b || run.i || run.u || run.color || run.link || rStyle) {\n          rPr = this.doc.el(\"w:rPr\");\n          if (run.link) {\n            if (rStyle) {\n              rPr.add(this.rStyleUnderline(this.doc.xdoc));\n            } else {\n              rPr.add(this.rStyleHyperlink(this.doc.xdoc));\n            }\n          }\n          if (rStyle) {\n            rPr.add(rStyle(this.doc.xdoc));\n          }\n          if (run.b) {\n            rPr.add(this.rStyleBold(this.doc.xdoc));\n          }\n          if (run.i) {\n            rPr.add(this.rStyleItalic(this.doc.xdoc));\n          }\n          if (run.u) {\n            rPr.add(this.rStyleUnderline(this.doc.xdoc));\n          }\n          if (run.color) {\n            rPr.add(_valBuild(\"w:color\", run.color)(this.doc.xdoc));\n          }\n          r.add(rPr);\n        }\n        t = this.doc.el(\"w:t\", run.text);\n        if (/^\\s+|\\s+$/.test(run.text)) {\n          t.setAttr(\"xml:space\", \"preserve\");\n        }\n        r.add(t);\n        if (run.link) {\n          var rId = this.doc.nextRelationshipId();\n          this.doc.addRelationship(rId, relTypes.hyperlink, run.link, \"External\");\n          r = this.doc.el(\"w:hyperlink\").setAttr(\"r:id\", rId).add(r);\n        }\n        parent.add(r);\n      }\n    },\n    _paragraph: function(parent, before, paragraph, pStyle, rStyle, pPrs) {\n      var p, pPr;\n      p = this.doc.el(\"w:p\");\n      if (pStyle || rStyle || pPrs) {\n        pPr = this.doc.el(\"w:pPr\");\n        if (pStyle) {\n          pPr.add(pStyle(this.doc.xdoc));\n        }\n        if (rStyle) {\n          pPr.add(this.doc.el(\"w:rPr\").add(rStyle(this.doc.xdoc)));\n        }\n        if (paragraph.hr) {\n          var hr = this.doc.el(\"w:pBdr\");\n          hr.add(this.doc.el(\"w:bottom\").setAttr(\"w:color\", \"auto\").setAttr(\"w:space\", \"1\").setAttr(\"w:sz\", \"6\").setAttr(\"w:val\", \"single\"));\n          pPr.add(hr);\n        }\n        if (pPrs) {\n          pPr.add(pPrs);\n        }\n        p.add(pPr);\n      }\n      this._runs(p, paragraph.runs, rStyle);\n      parent.add(p, before);\n    },\n    _table: function(parent, before, table) {\n      var i, j, row, cell, r, c, e, cspan, rspan, cind;\n      var tbl = this.doc.el(\"w:tbl\");\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          c = this.doc.el(\"w:tc\");\n          e = this.doc.el(\"w:tcPr\");\n          if (cspan > 1) {\n            e.add(this.doc.el(\"w:gridSpan\").setAttr(\"w:val\", cspan));\n          }\n          e.add(this.doc.el(\"w:vMerge\"));\n          c.add(e);\n          c.add(this.doc.el(\"w:p\"));\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          r.add(c);\n          cind += cspan;\n        }\n      };\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        r = this.doc.el(\"w:tr\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          c = this.doc.el(\"w:tc\");\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          cell = row.blocks[j];\n          e = this.doc.el(\"w:tcPr\");\n          if (cspan > 1) {\n            e.add(this.doc.el(\"w:gridSpan\").setAttr(\"w:val\", cspan));\n          }\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n            e.add(this.doc.el(\"w:vMerge\").setAttr(\"w:val\", \"restart\"));\n          }\n          c.add(e);\n          this._blocks(c, cell.blocks);\n          r.add(c);\n          cind += cspan;\n        }\n        spanned();\n        tbl.add(r);\n      }\n      parent.add(tbl, before);\n    }\n  };\n  (function() {\n    for (var f in XPkg.prototype) {\n      if (XPkg.prototype.hasOwnProperty(f)) {\n        DOCXBuilder.prototype[f] = XPkg.prototype[f];\n      }\n    }\n  })();\n  OpenXmlBuilder.DOCXBuilder = DOCXBuilder;\n  if (typeof define === \"function\" && define.amd) {\n    define(function() {\n      return OpenXmlBuilder;\n    });\n  } else if (typeof module === \"object\" && module && typeof module.exports === \"object\" && module.exports) {\n    module.exports = OpenXmlBuilder;\n  } else {\n    window.OpenXmlBuilder = OpenXmlBuilder;\n  }\n})(function() {\n  return this;\n}());"]}