{"version":3,"file":"OpenXmlBuilder.min.js","sources":["OpenXmlBuilder.js"],"names":["window","undefined","nsResolver","pref","ox","nameNS","name","rootNs","r","full","ns","oxNs","toks","split","length","use","docTemplate","t","xmlDoctype","arguments","i","openXmlISOString","date","pad2","number","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","nodeWrap","nodes","push","XNode","node","this","XDoc","xmlStr","charCodeAt","substring","doc","xhelp","makeDoc","root","getAttr","XPart","xpkg","contentType","path","relsXmlStr","idx","lastIndexOf","relsPath","slice","xdoc","relsXdoc","f","zip","file","asBinary","XPkg","b64Template","title","created","creator","JSZip","base64","checkCRC32","parts","Date","ctDoc","core","getPart","one","setValue","titleElement","add","el","leftPad","s","len","c","convertColor","tem","toString","toUpperCase","test","A","substr","colornames","match","indexOf","Math","round","parseFloat","parseInt","join","convertStyle","a","verticalAlign","sup","sub","fontWeight","isNaN","b","fontStyle","textDecoration","u","color","backgroundColor","bgColor","Blocker","blocks","block","convertHtml","html","d","document","createElement","p","head","body","appendChild","innerHTML","mblocker","procNodes","childNodes","removeChild","getBlocks","PPTXBuilder","call","slideCount","presentation","sldIdLst","es","all","remove","app","slidesProp","slidesTitlesProp","titlesVector","setAttr","rel","part","rels","getRelationshipsByRelationshipType","relTypes","slide","fullPath","deleteRelationship","relationshipId","deleted","_valBuild","e","v","w:val","DOCXBuilder","OpenXmlBuilder","version","xmlns","vt","dcterms","dc","cp","ep","w","ct","selNs","abbrev","hasOwnProperty","relTypePrefix","hyperlink","contTypes","relsTemplate","EGHelper","DOMParser","parseFromString","makeEl","tag","createElementNS","toXml","XMLSerializer","serializeToString","xpath","first","ownerDocument","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","rs","ORDERED_NODE_SNAPSHOT_TYPE","snapshotLength","snapshotItem","setNs","setAttributeNS","IEHelper","ActiveXObject","async","loadXML","setProperty","createNode","xml","selectSingleNode","selectNodes","value","setAttributeNode","XMLHelper","prototype","parentNode","nodeType","firstChild","txt","createTextNode","getValue","nodeValue","attr","setAttribute","getAttribute","removeAttr","removeAttribute","before","insertBefore","replace","replacement","documentElement","nextId","ids","setNamespace","toXmlString","nextRelationshipId","addRelationship","rId","type","target","mode","Target","Type","Id","TargetMode","apply","rtype","loadXml","strXml","override","addPart","addFile","data","cts","ContentType","PartName","deleteFile","relPath","ctxPath","slashIndex","undoPart","saveChanges","saveToBase64","generate","compression","saveToBlob","saveToDataURI","mimetype","getStyle","getComputedStyle","currentStyle","AQUA","BLACK","BLUE","FUCHSIA","GRAY","GREEN","LIME","MAROON","NAVY","OLIVE","PURPLE","RED","SILVER","TEAL","WHITE","YELLOW","addRun","style","text","run","currentBlock","runs","breakBlock","force","procNode","child","sblocker","cssStyle","display","isBlock","cstyle","tagName","listType","toLowerCase","link","href","hr","alt","src","children","slideLayout","addSlide","slideLayoutId","slideNum","sldId","slideUri","slideLayoutUri","sldTemplate","sld","r:id","id","contentSlide","content","shapes","spId","pptContent","_block","txBody","level","_blocks","_inlineTable","_paragraph","_runs","parent","rPr","lastLink","val","paragraph","pPr","table","j","cind","cspan","rspan","row","cell","colspans","spanned","colspan","rowspan","_table","k","tbl","phTxbody","phTc","shape","ps","pptLine","pptTable","graphicFrame","numbering","aFChunk","rStyleItalic","rStyleBold","rStyleUnderline","rStyleHyperlink","pStyleNoSpacing","pStyleListParagraph","pStyle","rStyle","_levelIndent","makeUl","makeList","fmt","fnt","makeOl","makeOlNum","makeOlHier","hier","levels","depth","numPart","nsid","random","anumid","listid","anum","lvl","lvlText","hLvlText","idt","heir","w:hanging","w:left","w:hint","w:hAnsi","w:ascii","num","docLine","seg","docContent","docChunk","uri","chunk","pPrs","define","amd","module","exports"],"mappings":"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","sourcesContent":["/*!\r\n * OpenXmlBuilder\r\n * The OpenXmlBuilder allows you to build simple OpenXml documents right in the browser.\r\n * Copyright (c) 2015 Jeremy Gore\r\n * Licensed MIT\r\n * https://github.com/jmgore75/openxmlbuilder\r\n * v0.1.0\r\n */\n(function(window, undefined) {\n  \"use strict\";\n  var OpenXmlBuilder = {};\n  OpenXmlBuilder.version = \"0.1.0\";\n  var ox = {};\n  ox.xmlns = \"http://www.w3.org/2000/xmlns/\";\n  ox.rel = \"http://schemas.openxmlformats.org/package/2006/relationships\";\n  ox.a = \"http://schemas.openxmlformats.org/drawingml/2006/main\";\n  ox.p = \"http://schemas.openxmlformats.org/presentationml/2006/main\";\n  ox.r = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\";\n  ox.vt = \"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\";\n  ox.dcterms = \"http://purl.org/dc/terms/\";\n  ox.dc = \"http://purl.org/dc/elements/1.1/\";\n  ox.cp = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\n  ox.ep = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\n  ox.w = \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\";\n  ox.ct = \"http://schemas.openxmlformats.org/package/2006/content-types\";\n  var oxNs = {};\n  var selNs = \"\";\n  (function() {\n    for (var abbrev in ox) {\n      if (ox.hasOwnProperty(abbrev)) {\n        oxNs[ox[abbrev]] = abbrev;\n        if (abbrev === \"xmlns\") {\n          selNs += \" xmlns='\" + ox[abbrev] + \"'\";\n        } else {\n          selNs += \" xmlns:\" + abbrev + \"='\" + ox[abbrev] + \"'\";\n        }\n      }\n    }\n  })();\n  selNs = selNs.slice(1);\n  function nsResolver(pref) {\n    return ox[pref] || null;\n  }\n  function nameNS(name, rootNs) {\n    var r = {\n      full: name,\n      name: name,\n      ns: rootNs\n    };\n    r.pref = oxNs[rootNs] || \"\";\n    var toks = name.split(\":\");\n    if (toks.length === 2) {\n      r.pref = toks[0];\n      r.name = toks[1];\n      r.ns = ox[r.pref] || null;\n    }\n    r.use = r.ns === rootNs ? r.name : r.full;\n    return r;\n  }\n  var relTypes = {};\n  var relTypePrefix = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/\";\n  relTypes.hyperlink = relTypePrefix + \"hyperlink\";\n  var contTypes = {};\n  var xmlDoctype = '<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>';\n  function docTemplate() {\n    var t = xmlDoctype;\n    t += \"<\" + arguments[0];\n    if (arguments.length > 1 && arguments[1]) {\n      t += \" xmlns='\" + ox[arguments[1]] + \"'\";\n    }\n    for (var i = 2; i < arguments.length; i++) {\n      t += \" xmlns:\" + arguments[i] + \"='\" + ox[arguments[i]] + \"'\";\n    }\n    t += \"></\" + arguments[0] + \">\";\n    return t;\n  }\n  var relsTemplate = docTemplate(\"Relationships\", \"rel\");\n  var EGHelper = {\n    makeDoc: function(xmlStr) {\n      return new DOMParser().parseFromString(xmlStr, \"text/xml\");\n    },\n    makeEl: function(doc, tag, rootNs) {\n      var r = nameNS(tag, rootNs);\n      return doc.createElementNS(r.ns || null, r.use);\n    },\n    toXml: function(doc) {\n      return new XMLSerializer().serializeToString(doc);\n    },\n    xpath: function(node, xpath, first) {\n      var doc = node.ownerDocument || node;\n      if (first) {\n        return doc.evaluate(xpath, node, nsResolver, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n      } else {\n        var rs = [];\n        var r = doc.evaluate(xpath, node, nsResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n        for (var i = 0; i < r.snapshotLength; i++) {\n          rs.push(r.snapshotItem(i));\n        }\n        return rs;\n      }\n    },\n    setNs: function(node, ns, abbrev) {\n      node.setAttributeNS(ox.xmlns, abbrev ? \"xmlns:\" + abbrev : \"xmlns\", ns);\n    }\n  };\n  var IEHelper = {\n    makeDoc: function(xmlStr) {\n      var doc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n      doc.async = \"false\";\n      doc.loadXML(xmlStr);\n      doc.setProperty(\"SelectionNamespaces\", selNs);\n      return doc;\n    },\n    makeEl: function(doc, tag, rootNs) {\n      var r = nameNS(tag, rootNs);\n      return doc.createNode(1, r.use, r.ns || null);\n    },\n    toXml: function(doc) {\n      return doc.xml;\n    },\n    xpath: function(node, xpath, first) {\n      if (first) {\n        return node.selectSingleNode(xpath);\n      } else {\n        return node.selectNodes(xpath);\n      }\n    },\n    setNs: function(node, ns, abbrev) {\n      var a = node.doc.createNode(2, abbrev ? \"xmlns:\" + abbrev : \"xmlns\", ox.xmlns);\n      a.value = ns;\n      node.setAttributeNode(a);\n    }\n  };\n  var xhelp = window.DOMParser ? EGHelper : IEHelper;\n  OpenXmlBuilder.XMLHelper = xhelp;\n  function openXmlISOString(date) {\n    function pad2(number) {\n      if (number < 10) {\n        return \"0\" + number;\n      }\n      return number;\n    }\n    return date.getUTCFullYear() + \"-\" + pad2(date.getUTCMonth() + 1) + \"-\" + pad2(date.getUTCDate()) + \"T\" + pad2(date.getUTCHours()) + \":\" + pad2(date.getUTCMinutes()) + \":\" + pad2(date.getUTCSeconds()) + \"Z\";\n  }\n  function nodeWrap(nodes) {\n    var r = [];\n    for (var i = 0; i < nodes.length; i++) {\n      r.push(new XNode(nodes[i]));\n    }\n    return r;\n  }\n  function XNode(node) {\n    this.node = node;\n  }\n  XNode.prototype = {\n    all: function(path) {\n      return nodeWrap(xhelp.xpath(this.node, path, false));\n    },\n    one: function(path) {\n      var node = xhelp.xpath(this.node, path, true);\n      return node ? new XNode(node) : null;\n    },\n    remove: function() {\n      this.node.parentNode.removeChild(this.node);\n    },\n    setValue: function(value) {\n      if (this.node.nodeType === 1) {\n        while (this.node.firstChild) {\n          this.node.removeChild(this.node.firstChild);\n        }\n        var txt = this.node.ownerDocument.createTextNode(value);\n        this.node.appendChild(txt);\n      } else if (this.node.nodeType === 2) {\n        this.value = value;\n      }\n      return this;\n    },\n    getValue: function() {\n      if (this.node.nodeType === 2) {\n        return this.value;\n      } else {\n        return this.node.nodeValue;\n      }\n    },\n    setAttr: function(attr, value) {\n      this.node.setAttribute(attr, value);\n      return this;\n    },\n    getAttr: function(attr) {\n      return this.node.getAttribute(attr);\n    },\n    removeAttr: function(attr) {\n      this.node.removeAttribute(attr);\n      return this;\n    },\n    add: function(el, before) {\n      if (before) {\n        this.node.insertBefore(el.node);\n      } else {\n        this.node.appendChild(el.node);\n      }\n      return this;\n    },\n    replace: function(replacement) {\n      this.node.insertBefore(replacement.node);\n      this.remove();\n      return replacement;\n    }\n  };\n  function XDoc(xmlStr) {\n    if (xmlStr.charCodeAt(0) === 65279) {\n      xmlStr = xmlStr.substring(1);\n    }\n    this.doc = xhelp.makeDoc(xmlStr);\n    this.rootNs = this.root().getAttr(\"xmlns\");\n  }\n  XDoc.prototype = {\n    el: function(tag, attr, value) {\n      var el = new XNode(xhelp.makeEl(this.doc, tag, this.rootNs));\n      if (!value && attr && typeof attr !== \"object\") {\n        value = attr;\n        attr = null;\n      }\n      if (attr) {\n        for (var a in attr) {\n          if (attr.hasOwnProperty(a)) {\n            el.setAttr(a, attr[a]);\n          }\n        }\n      }\n      if (value) {\n        el.setValue(value);\n      }\n      return el;\n    },\n    root: function() {\n      return new XNode(this.doc.documentElement);\n    },\n    all: function(path) {\n      return nodeWrap(xhelp.xpath(this.doc, path, false));\n    },\n    one: function(path) {\n      var node = xhelp.xpath(this.doc, path, true);\n      return node ? new XNode(node) : null;\n    },\n    nextId: function(path, attr, first, pref) {\n      first = first || 0;\n      pref = pref || \"\";\n      var ids = {};\n      var es = this.all(path);\n      for (var i = 0; i < es.length; i++) {\n        ids[es[i].getAttr(attr)] = 1;\n      }\n      while (ids[pref + first]) {\n        first += 1;\n      }\n      return pref + first;\n    },\n    setNamespace: function(ns, abbrev) {\n      xhelp.setNs(this.root(), ns, abbrev);\n      if (!abbrev) {\n        this.rootNs = ns;\n      }\n    },\n    toXmlString: function() {\n      return xhelp.toXml(this.doc);\n    }\n  };\n  function XPart(xpkg, contentType, path, xmlStr, relsXmlStr) {\n    this.xpkg = xpkg;\n    this.path = path;\n    this.contentType = contentType;\n    var idx = path.lastIndexOf(\"/\") + 1;\n    this.relsPath = path.slice(0, idx) + \"_rels/\" + path.slice(idx) + \".rels\";\n    if (xmlStr) {\n      this.xdoc = new XDoc(xmlStr);\n      if (relsXmlStr) {\n        this.relsXdoc = new XDoc(relsXmlStr);\n      }\n    } else {\n      var f = this.xpkg.zip.file(this.path.slice(1));\n      if (f) {\n        this.xdoc = new XDoc(f.asBinary());\n        f = this.xpkg.zip.file(this.relsPath.slice(1));\n        if (f) {\n          this.relsXdoc = new XDoc(f.asBinary());\n        }\n      }\n    }\n  }\n  XPart.prototype = {\n    nextRelationshipId: function() {\n      if (!this.relsXdoc) {\n        return \"rId1\";\n      }\n      return this.relsXdoc.nextId(\"/rel:Relationships/rel:Relationship\", \"Id\", 1, \"rId\");\n    },\n    addRelationship: function(rId, type, target, mode) {\n      if (!this.relsXdoc) {\n        this.relsXdoc = new XDoc(relsTemplate);\n      }\n      var attr = {\n        Target: target,\n        Type: type,\n        Id: rId\n      };\n      mode = mode || \"External\";\n      if (mode !== \"Internal\") {\n        attr.TargetMode = mode;\n      }\n      var e = this.relsXdoc.el(\"rel:Relationship\", attr);\n      this.relsXdoc.root().add(e);\n    },\n    deleteRelationship: function(rId) {\n      if (this.relsXdoc) {\n        var es = this.relsXdoc.all(\"/rel:Relationships/rel:Relationship\");\n        for (var i = 0; i < es.length; i++) {\n          if (es[i].getAttr(\"Id\") === rId) {\n            es[i].remove();\n            if (es.length === 1) {\n              delete this.relsXdoc;\n            }\n            return;\n          }\n        }\n      }\n    },\n    el: function() {\n      return this.xdoc.el.apply(this.xdoc, arguments);\n    },\n    root: function() {\n      return this.xdoc.root();\n    },\n    all: function() {\n      return this.xdoc.all.apply(this.xdoc, arguments);\n    },\n    one: function() {\n      return this.xdoc.one.apply(this.xdoc, arguments);\n    },\n    nextId: function() {\n      return this.xdoc.nextId.apply(this.xdoc, arguments);\n    },\n    setNamespace: function() {\n      return this.xdoc.setNamespace.apply(this.xdoc, arguments);\n    },\n    getRelationshipsByRelationshipType: function(rtype) {\n      return this.relsXdoc.all(\"/rel:Relationships/rel:Relationship[@Type='\" + rtype + \"']\");\n    },\n    loadXml: function(strXml) {\n      this.xdoc = new XDoc(strXml);\n    }\n  };\n  function XPkg(b64Template, title, created, creator) {\n    this.zip = new JSZip(b64Template, {\n      base64: true,\n      checkCRC32: false\n    });\n    this.parts = {};\n    created = created || new Date();\n    title = title || \"Document \" + openXmlISOString(created);\n    creator = creator || \"OpenXmlBuilder\";\n    this.ctDoc = new XDoc(this.zip.file(\"[Content_Types].xml\").asBinary());\n    var core = this.getPart(\"/docProps/core.xml\").xdoc;\n    core.one(\"//dcterms:created\").setValue(openXmlISOString(created));\n    core.one(\"//dcterms:modified\").setValue(openXmlISOString(created));\n    if (title) {\n      var titleElement = core.one(\"//dc:title\");\n      if (titleElement) {\n        titleElement.setValue(title);\n      } else {\n        core.root().add(core.el(\"dc:title\", title));\n      }\n    }\n    if (creator) {\n      core.one(\"//dc:creator\").setValue(creator);\n      core.one(\"//cp:lastModifiedBy\").setValue(creator);\n    }\n  }\n  XPkg.prototype = {\n    getPart: function(path) {\n      if (this.parts.hasOwnProperty(path)) {\n        return this.parts[path];\n      } else {\n        var override = this.ctDoc.one(\"/ct:Types/ct:Override[@PartName='\" + path + \"']\");\n        var part = override ? new XPart(this, override.getAttr(\"ContentType\"), path) : null;\n        this.parts[path] = part;\n        return part;\n      }\n    },\n    addPart: function(contentType, path, xmlStr, relsXmlStr) {\n      var part = new XPart(this, contentType, path, xmlStr, relsXmlStr);\n      this.parts[path] = part;\n      return part;\n    },\n    addFile: function(ct, path, data) {\n      this.zip.file(path.slice(1), data);\n      var cts = this.ctDoc.all(\"/ct:Types/ct:Override\");\n      for (var i = 0; i < cts.length; i++) {\n        if (cts[i].getAttr(\"PartName\") === path) {\n          cts[i].remove();\n        }\n      }\n      var e = this.ctDoc.el(\"ct:Override\", {\n        ContentType: ct,\n        PartName: path\n      });\n      this.ctDoc.root().add(e);\n    },\n    deleteFile: function(path) {\n      this.zip.remove(path);\n      var cts = this.ctDoc.all(\"/ct:Types/ct:Override\");\n      for (var i = 0; i < cts.length; i++) {\n        if (cts[i].getAttr(\"PartName\") === path) {\n          cts[i].remove();\n        }\n      }\n    },\n    fullPath: function(relPath, ctxPath) {\n      if (relPath.indexOf(\"/\") === 0) {\n        return relPath;\n      }\n      ctxPath = ctxPath || \"/\";\n      var slashIndex = ctxPath.lastIndexOf(\"/\");\n      ctxPath = ctxPath.slice(0, slashIndex + 1);\n      while (relPath.indexOf(\"../\") === 0) {\n        ctxPath = ctxPath.slice(0, ctxPath.length - 1);\n        slashIndex = ctxPath.lastIndexOf(\"/\");\n        if (slashIndex === -1) {\n          throw \"internal error when processing relationships\";\n        }\n        ctxPath = ctxPath.slice(0, slashIndex + 1);\n        relPath = relPath.slice(3);\n      }\n      return ctxPath + relPath;\n    },\n    undoPart: function(path) {\n      delete this.parts[path];\n    },\n    saveChanges: function() {\n      var part;\n      for (var path in this.parts) {\n        if (this.parts.hasOwnProperty(path)) {\n          part = this.parts[path];\n          if (part.deleted || !part.xdoc) {\n            this.deleteFile(part.path);\n            this.zip.remove(part.relsPath);\n          } else {\n            this.addFile(part.contentType, part.path, part.xdoc.toXmlString());\n            if (part.relsXdoc) {\n              this.zip.file(part.relsPath.slice(1), part.relsXdoc.toXmlString());\n            } else {\n              this.zip.remove(part.relsPath);\n            }\n          }\n        }\n      }\n      this.parts = {};\n      this.zip.file(\"[Content_Types].xml\", this.ctDoc.toXmlString());\n      return this.zip;\n    },\n    saveToBase64: function() {\n      return this.saveChanges().generate({\n        compression: \"deflate\",\n        type: \"base64\"\n      });\n    },\n    saveToBlob: function() {\n      return this.saveChanges().generate({\n        compression: \"deflate\",\n        type: \"blob\"\n      });\n    },\n    saveToDataURI: function() {\n      return \"data:\" + this.mimetype + \";base64,\" + this.saveToBase64();\n    }\n  };\n  var getStyle = window.getComputedStyle || function(e) {\n    return e.currentStyle;\n  };\n  function leftPad(s, len, c) {\n    c = c || \" \";\n    len = len || 2;\n    while (s.length < len) {\n      s = c + s;\n    }\n    return s;\n  }\n  var colornames = {\n    AQUA: \"00FFFF\",\n    BLACK: \"000000\",\n    BLUE: \"0000FF\",\n    FUCHSIA: \"FF00FF\",\n    GRAY: \"808080\",\n    GREEN: \"008000\",\n    LIME: \"00FF00\",\n    MAROON: \"800000\",\n    NAVY: \"000080\",\n    OLIVE: \"808000\",\n    PURPLE: \"800080\",\n    RED: \"FF0000\",\n    SILVER: \"C0C0C0\",\n    TEAL: \"008080\",\n    WHITE: \"FFFFFF\",\n    YELLOW: \"FFFF00\"\n  };\n  function convertColor(c) {\n    var tem, i = 0;\n    c = c ? c.toString().toUpperCase() : \"\";\n    if (/^#[A-F0-9]{3,6}$/.test(c)) {\n      if (c.length < 7) {\n        var A = c.split(\"\");\n        c = A[1] + A[1] + A[2] + A[2] + A[3] + A[3];\n      } else {\n        c = c.substr(1, 8);\n      }\n      return c;\n    }\n    if (/^[A-Z]+$/.test(c)) {\n      return colornames[c] || \"\";\n    }\n    c = c.match(/\\d+(\\.\\d+)?%?/g) || [];\n    if (c.length < 3 || c.length > 4) {\n      return \"\";\n    }\n    for (i = 0; i < c.length; i++) {\n      tem = c[i];\n      if (tem.indexOf(\"%\") !== -1) {\n        tem = Math.round(parseFloat(tem) * 2.55);\n      } else {\n        tem = parseInt(tem, 10);\n      }\n      if (tem < 0 || tem > 255) {\n        return \"\";\n      } else {\n        c[i] = leftPad(tem.toString(16).toUpperCase(), 2, \"0\");\n      }\n    }\n    if (c.length === 4 && c[3] === \"00\") {\n      return \"\";\n    }\n    return c.slice(0, 3).join(\"\");\n  }\n  function convertStyle(s) {\n    var a = {};\n    if (s.verticalAlign === \"super\") {\n      a.sup = 1;\n    }\n    if (s.verticalAlign === \"sub\") {\n      a.sub = 1;\n    }\n    var i = parseInt(s.fontWeight, 10);\n    if (isNaN(i)) {\n      if (s.fontWeight === \"bold\") {\n        a.b = 1;\n      }\n    } else {\n      if (i >= 700) {\n        a.b = 1;\n      }\n    }\n    if (s.fontStyle === \"italic\") {\n      a.i = 1;\n    }\n    if (s.textDecoration === \"underline\") {\n      a.u = 1;\n    }\n    var color = convertColor(s.color);\n    if (color && color !== \"000000\") {\n      a.color = color;\n    }\n    color = convertColor(s.backgroundColor);\n    if (color && color !== \"FFFFFF\") {\n      a.bgColor = color;\n    }\n    return a;\n  }\n  function Blocker() {\n    this.blocks = [];\n    this.block = null;\n  }\n  Blocker.prototype = {\n    addRun: function(style, text) {\n      var run = {};\n      for (var attr in style) {\n        if (style.hasOwnProperty(attr)) {\n          run[attr] = style[attr];\n        }\n      }\n      run.text = text;\n      var block = this.currentBlock();\n      block.runs.push(run);\n      return run;\n    },\n    currentBlock: function() {\n      if (!this.block) {\n        this.block = {\n          type: \"paragraph\",\n          runs: []\n        };\n      }\n      return this.block;\n    },\n    breakBlock: function(force) {\n      if (this.block || force) {\n        var block = this.currentBlock();\n        this.blocks.push(block);\n        this.block = null;\n        return block;\n      } else if (this.blocks.length) {\n        return this.blocks[this.blocks.length - 1];\n      }\n    },\n    getBlocks: function() {\n      this.breakBlock();\n      return this.blocks;\n    },\n    procNode: function(style, child) {\n      var sblocker;\n      if (child.nodeType === 3) {\n        this.addRun(style, child.nodeValue);\n      } else if (child.nodeType === 1) {\n        var cssStyle = getStyle(child);\n        if (cssStyle.display === \"none\") {\n          return;\n        }\n        var isBlock = cssStyle.display === \"block\";\n        var cstyle = convertStyle(cssStyle);\n        if (isBlock) {\n          this.breakBlock();\n        }\n        if (child.tagName === \"LI\") {\n          this.breakBlock();\n          this.currentBlock().type = \"list-item\";\n          this.procNodes(cstyle, child.childNodes);\n        } else if (child.tagName === \"OL\" || child.tagName === \"UL\") {\n          this.breakBlock();\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"list\",\n            listType: child.tagName.toLowerCase(),\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"TABLE\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table\",\n            blocks: sblocker.blocks\n          });\n        } else if (child.tagName === \"TR\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table-row\",\n            blocks: sblocker.blocks\n          });\n        } else if (child.tagName === \"TD\" || child.tagName === \"TH\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table-cell\",\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"A\") {\n          cstyle.link = child.href;\n          this.procNodes(cstyle, child.childNodes);\n        } else if (child.tagName === \"HR\") {\n          this.currentBlock().hr = true;\n          this.breakBlock();\n        } else if (child.tagName === \"BR\") {\n          this.breakBlock();\n        } else if (child.tagName === \"IMG\") {\n          var run = this.addRun(cstyle, \"[\" + (child.alt || child.title || \"IMAGE\") + \"]\");\n          run.link = child.src;\n        } else {\n          this.procNodes(cstyle, child.childNodes);\n        }\n      }\n    },\n    procNodes: function(style, children) {\n      for (var i = 0; i < children.length; i++) {\n        this.procNode(style, children[i]);\n      }\n    }\n  };\n  function convertHtml(html) {\n    var d = document.createElement(\"DIV\");\n    var p = document.head || document.body;\n    p.appendChild(d);\n    d.innerHTML = html;\n    var mblocker = new Blocker();\n    mblocker.procNodes({}, d.childNodes);\n    p.removeChild(d);\n    d = null;\n    return mblocker.getBlocks();\n  }\n  OpenXmlBuilder.convertHtml = convertHtml;\n  relTypes.slideLayout = relTypePrefix + \"slideLayout\";\n  relTypes.slide = relTypePrefix + \"slide\";\n  contTypes.slide = \"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\";\n  function PPTXBuilder(b64Template, title, created, creator) {\n    XPkg.call(this, b64Template, title, created, creator);\n    this.slideCount = 0;\n    this.presentation = this.getPart(\"/ppt/presentation.xml\");\n    this.sldIdLst = this.presentation.one(\"/p:presentation/p:sldIdLst\");\n    var es = this.sldIdLst.all(\"./p:sldId\");\n    for (var i = 0; i < es.length; i++) {\n      es[i].remove();\n    }\n    this.app = this.getPart(\"/docProps/app.xml\").xdoc;\n    this.slidesProp = this.app.one(\"/ep:Properties/ep:Slides\");\n    this.slidesProp.setValue(\"0\");\n    this.slidesTitlesProp = this.app.all(\"/ep:Properties/ep:HeadingPairs/vt:vector/vt:variant/vt:i4\");\n    this.slidesTitlesProp = this.slidesTitlesProp[this.slidesTitlesProp.length - 1];\n    this.slidesTitlesProp.setValue(\"0\");\n    this.titlesVector = this.app.one(\"/ep:Properties/ep:TitlesOfParts/vt:vector\");\n    this.titlesVector.setAttr(\"size\", \"1\");\n    es = this.titlesVector.all(\"./vt:lpstr\");\n    for (i = 1; i < es.length; i++) {\n      es[i].remove();\n    }\n    var rels = this.presentation.getRelationshipsByRelationshipType(relTypes.slide);\n    var rel, part;\n    for (i = 0; i < rels.length; i++) {\n      rel = rels[i];\n      part = this.getPart(this.fullPath(rel.getAttr(\"Target\"), this.presentation.path));\n      this.presentation.deleteRelationship(rel.relationshipId);\n      part.deleted = true;\n    }\n  }\n  PPTXBuilder.prototype = {\n    mimetype: \"application/vnd.openxmlformats-officedocument.presentationml.presentation\",\n    addSlide: function(title, slideLayoutId) {\n      slideLayoutId = slideLayoutId || 2;\n      this.slideCount++;\n      var slideNum = this.slideCount;\n      var sldId = slideNum + 255;\n      title = title || \"Slide \" + slideNum;\n      var slideUri = \"slides/slide\" + slideNum + \".xml\";\n      var slideLayoutUri = \"slideLayouts/slideLayout\" + slideLayoutId + \".xml\";\n      var slideLayout = this.getPart(\"/ppt/\" + slideLayoutUri);\n      var sldTemplate = slideLayout.xdoc.toXmlString();\n      sldTemplate = sldTemplate.replace(/(<\\/?p:sld)Layout/g, \"$1\");\n      var slide = this.addPart(contTypes.slide, \"/ppt/\" + slideUri, sldTemplate);\n      slide.addRelationship(slide.nextRelationshipId(), relTypes.slideLayout, \"../\" + slideLayoutUri, \"Internal\");\n      var sld = slide.xdoc.root();\n      sld.removeAttr(\"preserve\");\n      sld.removeAttr(\"type\");\n      sld.one(\"p:cSld\").removeAttr(\"name\");\n      var rId = this.presentation.nextRelationshipId();\n      this.presentation.addRelationship(rId, relTypes.slide, slideUri, \"Internal\");\n      this.sldIdLst.add(this.presentation.el(\"p:sldId\", {\n        \"r:id\": rId,\n        id: sldId\n      }));\n      this.slidesProp.setValue(slideNum);\n      this.slidesTitlesProp.setValue(slideNum);\n      this.titlesVector.add(this.app.el(\"vt:lpstr\", title));\n      this.titlesVector.setAttr(\"size\", slideNum + 1);\n      return slide;\n    },\n    contentSlide: function(content, slideLayoutId) {\n      slideLayoutId = slideLayoutId || 2;\n      var title = content.title || content[\"Title 1\"];\n      var slide = this.addSlide(title, slideLayoutId);\n      var shapes = slide.all(\"//p:sp\");\n      for (var i = 0; i < shapes.length; i++) {\n        var spId = shapes[i].one(\"./p:nvSpPr/p:cNvPr\").getAttr(\"name\");\n        var html = content[spId];\n        if (html) {\n          this.pptContent(slide, shapes[i], html);\n        } else {\n          shapes[i].remove();\n        }\n      }\n    },\n    _block: function(slide, txBody, block, listType, level) {\n      if (block.type === \"list\") {\n        listType = block.listType || \"ul\";\n        level = level >= 0 ? level += 1 : 0;\n        this._blocks(slide, txBody, block.blocks, listType, level);\n      } else if (block.type === \"table\") {\n        this._inlineTable(slide, txBody, block);\n      } else if (block.type === \"list-item\") {\n        this._paragraph(slide, txBody, block, listType, level);\n      } else {\n        this._paragraph(slide, txBody, block, null, level);\n      }\n    },\n    _blocks: function(slide, txBody, blocks, listType, level) {\n      for (var i = 0; i < blocks.length; i++) {\n        this._block(slide, txBody, blocks[i], listType, level);\n      }\n    },\n    _runs: function(slide, parent, runs) {\n      var run, r, rPr, t, rId;\n      var lastLink;\n      for (var i = 0; i < runs.length; i++) {\n        run = runs[i];\n        r = slide.el(\"a:r\");\n        lastLink = run.link;\n        if (run.b || run.i || run.u || run.color || run.link) {\n          rPr = slide.el(\"a:rPr\");\n          if (run.b) {\n            rPr.setAttr(\"b\", \"1\");\n          }\n          if (run.i) {\n            rPr.setAttr(\"i\", \"1\");\n          }\n          if (run.u) {\n            rPr.setAttr(\"u\", \"sng\");\n          }\n          if (run.color) {\n            rPr.add(slide.el(\"a:solidFill\").add(slide.el(\"a:srgbClr\", {\n              val: run.color\n            })));\n          }\n          if (run.link) {\n            rId = slide.nextRelationshipId();\n            slide.addRelationship(rId, relTypes.hyperlink, run.link, \"External\");\n            rPr.add(slide.el(\"a:hlinkClick\", {\n              \"r:id\": rId\n            }));\n          }\n          r.add(rPr);\n        }\n        t = slide.el(\"a:t\", run.text);\n        r.add(t);\n        parent.add(r);\n      }\n      if (lastLink) {\n        parent.add(slide.el(\"a:endParaRPr\").add(slide.el(\"a:hlinkClick\", {\n          \"r:id\": \"\"\n        })));\n      }\n    },\n    _paragraph: function(slide, parent, paragraph, listType, level) {\n      var p, pPr;\n      p = slide.el(\"a:p\");\n      if (level >= 0 || listType !== \"ul\") {\n        pPr = slide.el(\"a:pPr\");\n        p.add(pPr);\n        if (level > 0) {\n          pPr.setAttr(\"lvl\", level);\n        }\n        if (listType === \"ol\") {\n          pPr.add(slide.el(\"a:buAutoNum\", {\n            type: \"arabicPeriod\"\n          }));\n        } else if (!listType) {\n          pPr.add(slide.el(\"a:buNone\"));\n        }\n        if (!listType && level >= 0) {\n          p.add(slide.el(\"a:r\").add(slide.el(\"a:t\", \"\t\")));\n        }\n      }\n      this._runs(slide, p, paragraph.runs);\n      parent.add(p);\n    },\n    _inlineTable: function(slide, parent, table, listType, level) {\n      var i, j, cind, cspan, rspan, row, cell;\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          cind += cspan;\n        }\n      };\n      this._paragraph(slide, parent, {\n        runs: [ {\n          u: true,\n          i: true,\n          text: \"Table\"\n        } ]\n      }, listType, level);\n      level = (level || 0) + 1;\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        this._paragraph(slide, parent, {\n          runs: [ {\n            u: true,\n            i: true,\n            text: \"Row \" + (row + 1)\n          } ]\n        }, null, level);\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          cell = row.blocks[j];\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          this._paragraph(slide, parent, {\n            runs: [ {\n              i: true,\n              text: \"Column\" + (cind + 1)\n            } ]\n          }, null, level + 1);\n          this._blocks(slide, parent, cell, null, level + 1);\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n          }\n          cind += cspan;\n        }\n        spanned();\n      }\n    },\n    _table: function(slide, parent, table) {\n      var i, j, k, row, cell, r, c, e, cspan, rspan, cind;\n      var tbl = slide.el(\"a:tbl\");\n      var phTxbody = function() {\n        return slide.el(\"a:txBody\").add(slide.el(\"a:bodyPr\")).add(slide.el(\"a:lstStyle\"));\n      };\n      var phTc = function() {\n        return slide.el(\"a:tc\").add(phTxbody().add(slide.el(\"a:p\"))).add(slide.el(\"a:tcPr\"));\n      };\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          var c = phTc().setAttr(\"vMerge\", 1);\n          r.add(c);\n          if (cspan > 1) {\n            c.setAttr(\"gridSpan\", cspan);\n            for (k = 1; k < cspan; k++) {\n              r.add(phTc().setAttr(\"hMerge\", 1).setAttr(\"vMerge\", 1));\n            }\n          }\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          cind += cspan;\n        }\n      };\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        r = slide.el(\"a:tr\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          cell = row.blocks[j];\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          c = slide.el(\"a:tc\");\n          r.add(c);\n          if (cspan > 1) {\n            c.setAttr(\"gridSpan\", cspan);\n            for (k = 1; k < cspan; k++) {\n              r.add(phTc().setAttr(\"hMerge\", 1));\n            }\n          }\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n          }\n          e = phTxbody();\n          c.add(e);\n          this._blocks(e, cell.blocks);\n          e = slide.el(\"a:tcPr\");\n          c.add(e);\n          cind += cspan;\n        }\n        spanned();\n        tbl.add(r);\n      }\n      parent.add(tbl);\n    },\n    pptContent: function(slide, shape, html) {\n      var txBody = shape.one(\"./p:txBody\");\n      var ps = txBody.all(\"./a:p\");\n      for (var j = 0; j < ps.length; j++) {\n        ps[j].remove();\n      }\n      var blocks = convertHtml(html);\n      this._blocks(slide, txBody, blocks);\n    },\n    pptLine: function(slide, shape, html) {\n      var txBody = shape.one(\"./p:txBody\");\n      var ps = txBody.all(\"./a:p\");\n      for (var j = 0; j < ps.length; j++) {\n        ps[j].remove();\n      }\n      var blocks = convertHtml(html);\n      if (blocks.length === 1 && blocks[0].type === \"paragraph\") {\n        var block = blocks[0];\n        this._paragraph(slide, txBody, block);\n      } else {\n        throw \"Content is not a single paragraph\";\n      }\n    },\n    pptTable: function(slide, shape, html) {\n      var graphicFrame = slide.el(\"p:graphicFrame\");\n      var a, b, c, i;\n      a = slide.el(\"p:nvGraphicFramePr\");\n      graphicFrame.add(a);\n      b = shape.one(\"./p:cNvPr\");\n      if (b) {\n        a.add(b);\n      }\n      b = shape.one(\"./p:cNvSpPr\");\n      if (b) {\n        c = slide.el(\"p:cNvGraphicFramePr\");\n        b = b.all(\"./*\");\n        for (i = 0; i < b.length; i++) {\n          c.add(b[i]);\n        }\n        a.add(c);\n      }\n      b = shape.one(\"./p:nvPr\");\n      if (b) {\n        b.add(b);\n      }\n      a = slide.el(\"a:graphic\");\n      graphicFrame.add(a);\n      b = slide.el(\"a:graphicData\").setAttr(\"uri\", \"http://schemas.openxmlformats.org/drawingml/2006/table\");\n      a.add(b);\n      shape.replace(graphicFrame);\n      var blocks = convertHtml(html);\n      if (blocks.length === 1 && blocks[0].type === \"table\") {\n        var block = blocks[0];\n        this._table(slide, b, block);\n      } else {\n        throw \"Content is not a table\";\n      }\n    }\n  };\n  (function() {\n    for (var f in XPkg.prototype) {\n      if (XPkg.prototype.hasOwnProperty(f)) {\n        PPTXBuilder.prototype[f] = XPkg.prototype[f];\n      }\n    }\n  })();\n  OpenXmlBuilder.PPTXBuilder = PPTXBuilder;\n  relTypes.numbering = relTypePrefix + \"numbering\";\n  relTypes.aFChunk = relTypePrefix + \"aFChunk\";\n  contTypes.numbering = \"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml\";\n  function _valBuild(e, v) {\n    return function(xdoc) {\n      return xdoc.el(e, {\n        \"w:val\": v\n      });\n    };\n  }\n  function DOCXBuilder(b64Template, title, created, creator) {\n    XPkg.call(this, b64Template, title, created, creator);\n    this.doc = this.getPart(\"/word/document.xml\");\n    this.body = this.doc.one(\"/w:document/w:body\");\n    var es = this.body.all(\"./*\");\n    for (var i = 0; i < es.length; i++) {\n      es[i].remove();\n    }\n  }\n  DOCXBuilder.prototype = {\n    mimetype: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n    rStyleItalic: function(xdoc) {\n      return xdoc.el(\"w:i\");\n    },\n    rStyleBold: function(xdoc) {\n      return xdoc.el(\"w:b\");\n    },\n    rStyleUnderline: _valBuild(\"w:u\", \"single\"),\n    rStyleHyperlink: _valBuild(\"w:rStyle\", \"Hyperlink\"),\n    pStyleNoSpacing: _valBuild(\"w:pStyle\", \"NoSpacing\"),\n    pStyleListParagraph: _valBuild(\"w:pStyle\", \"ListParagraph\"),\n    pStyle: function(name) {\n      return _valBuild(\"w:pStyle\", name);\n    },\n    rStyle: function(name) {\n      if (name === \"Italic\") {\n        return this.rStyleItalic;\n      } else if (name === \"Bold\") {\n        return this.rStyleBold;\n      } else if (name === \"Underline\") {\n        return this.rStyleUnderline;\n      }\n      return _valBuild(\"w:rStyle\", name);\n    },\n    _levelIndent: function(level) {\n      return 720 * (1 + (level || 0));\n    },\n    makeUl: function() {\n      return this.makeList([ {\n        fmt: \"bullet\",\n        fnt: \"Symbol\",\n        txt: \"·\"\n      }, {\n        fmt: \"bullet\",\n        fnt: \"Courier New\",\n        txt: \"o\"\n      }, {\n        fmt: \"bullet\",\n        fnt: \"Wingdings\",\n        txt: \"§\"\n      } ], 9);\n    },\n    makeOl: function() {\n      return this.makeList([ {\n        fmt: \"decimal\"\n      }, {\n        fmt: \"lowerLetter\"\n      }, {\n        fmt: \"lowerRoman\"\n      } ], 9);\n    },\n    makeOlNum: function() {\n      return this.makeList([ {\n        fmt: \"decimal\"\n      } ], 9);\n    },\n    makeOlHier: function() {\n      return this.makeList([ {\n        fmt: \"decimal\",\n        hier: true\n      } ], 9);\n    },\n    makeList: function(levels, depth) {\n      var numPart = this.getPart(\"/word/numbering.xml\");\n      if (!numPart) {\n        numPart = this.addPart(contTypes.numbering, \"/word/numbering.xml\", docTemplate(\"w:numbering\", null, \"w\"));\n        this.doc.addRelationship(this.doc.nextRelationshipId(), relTypes.numbering, \"numbering.xml\", \"Internal\");\n      }\n      var nsid = Math.random().toString(16).substring(2, 10).toUpperCase();\n      var anumid = numPart.nextId(\"//w:abstractNum\", \"w:abstractNumId\", 0);\n      var listid = numPart.nextId(\"//w:num\", \"w:numId\", 1);\n      var anum = numPart.el(\"w:abstractNum\").setAttr(\"w:abstractNumId\", anumid);\n      anum.add(numPart.el(\"w:nsid\").setAttr(\"w:val\", nsid));\n      anum.add(numPart.el(\"w:multiLevelType\").setAttr(\"w:val\", \"hybridMultilevel\"));\n      var lvl, level, lvlText, hLvlText, idt;\n      depth = depth || levels.length;\n      for (var i = 0; i < depth; i++) {\n        level = levels[i % levels.length];\n        idt = this._levelIndent(i);\n        lvl = numPart.el(\"w:lvl\").setAttr(\"w:ilvl\", i);\n        lvl.add(numPart.el(\"w:start\").setAttr(\"w:val\", \"1\"));\n        lvl.add(numPart.el(\"w:numFmt\").setAttr(\"w:val\", level.fmt));\n        if (level.fmt === \"bullet\") {\n          lvlText = level.txt || \" \";\n          hLvlText = \"\";\n        } else {\n          lvlText = \"%\" + (i + 1) + \".\";\n          hLvlText += lvlText;\n        }\n        lvl.add(numPart.el(\"w:lvlText\").setAttr(\"w:val\", level.heir ? hLvlText : lvlText));\n        lvl.add(numPart.el(\"w:lvlJc\").setAttr(\"w:val\", \"left\"));\n        lvl.add(numPart.el(\"w:pPr\").add(numPart.el(\"w:ind\", {\n          \"w:hanging\": \"360\",\n          \"w:left\": idt\n        })));\n        if (level.fnt) {\n          lvl.add(numPart.el(\"w:rPr\").add(numPart.el(\"w:rFonts\", {\n            \"w:hint\": \"default\",\n            \"w:hAnsi\": level.fnt,\n            \"w:ascii\": level.fnt\n          })));\n        }\n        anum.add(lvl);\n      }\n      var num = numPart.el(\"w:num\").setAttr(\"w:numId\", listid);\n      num.add(numPart.el(\"w:abstractNumId\").setAttr(\"w:val\", anumid));\n      numPart.xdoc.root().add(anum);\n      numPart.xdoc.root().add(num);\n      return listid;\n    },\n    docLine: function(html, pStyle, rStyle) {\n      var seg = convertHtml(html);\n      if (seg.length === 1 && seg[0].type === \"paragraph\") {\n        seg = seg[0];\n        this._paragraph(this.body, seg, pStyle, rStyle);\n      } else {\n        throw \"Content is too complex\";\n      }\n    },\n    docContent: function(html) {\n      var blocks = convertHtml(html);\n      this._blocks(this.body, blocks);\n    },\n    docChunk: function(html) {\n      html = \"<html><head></head><body>\" + html + \"</body></html>\";\n      var rId = this.doc.nextRelationshipId();\n      var uri = \"/word/chunk\" + rId + \".html\";\n      this.addFile(\"text/html\", uri, html);\n      this.doc.addRelationship(rId, relTypes.aFChunk, uri, \"Internal\");\n      var chunk = this.doc.el(\"w:altChunk\").setAttr(\"r:id\", rId);\n      this.body.add(chunk);\n    },\n    _block: function(parent, block, listid, level) {\n      var pPrs;\n      if (block.type === \"table\") {\n        this._table(parent, block);\n      } else if (block.type === \"list\") {\n        if (!listid) {\n          listid = block.listType === \"ul\" ? this.makeUl() : this.makeOlHier();\n          level = 0;\n        } else {\n          level += 1;\n        }\n        this._blocks(parent, block.blocks, listid, level);\n      } else if (block.type === \"list-item\" && listid) {\n        pPrs = this.doc.el(\"w:numPr\");\n        pPrs.add(_valBuild(\"w:ilvl\", level)(this.doc.xdoc));\n        pPrs.add(_valBuild(\"w:numId\", listid)(this.doc.xdoc));\n        this._paragraph(parent, block, null, null, pPrs);\n      } else if (listid) {\n        pPrs = this.doc.el(\"w:ind\").setAttr(\"w:left\", this._levelIndent(level));\n        this._paragraph(parent, block, this.pStyleListParagraph, null, pPrs);\n      } else {\n        this._paragraph(parent, block);\n      }\n    },\n    _blocks: function(parent, blocks, listid, level) {\n      for (var i = 0; i < blocks.length; i++) {\n        this._block(parent, blocks[i], listid, level);\n      }\n    },\n    _runs: function(parent, runs, rStyle) {\n      var run, r, rPr, t;\n      for (var i = 0; i < runs.length; i++) {\n        run = runs[i];\n        r = this.doc.el(\"w:r\");\n        if (run.b || run.i || run.u || run.color || run.link || rStyle) {\n          rPr = this.doc.el(\"w:rPr\");\n          if (run.link) {\n            if (rStyle) {\n              rPr.add(this.rStyleUnderline(this.doc.xdoc));\n            } else {\n              rPr.add(this.rStyleHyperlink(this.doc.xdoc));\n            }\n          }\n          if (rStyle) {\n            rPr.add(rStyle(this.doc.xdoc));\n          }\n          if (run.b) {\n            rPr.add(this.rStyleBold(this.doc.xdoc));\n          }\n          if (run.i) {\n            rPr.add(this.rStyleItalic(this.doc.xdoc));\n          }\n          if (run.u) {\n            rPr.add(this.rStyleUnderline(this.doc.xdoc));\n          }\n          if (run.color) {\n            rPr.add(_valBuild(\"w:color\", run.color)(this.doc.xdoc));\n          }\n          r.add(rPr);\n        }\n        t = this.doc.el(\"w:t\", run.text);\n        if (/^\\s+|\\s+$/.test(run.text)) {\n          t.setAttr(\"xml:space\", \"preserve\");\n        }\n        r.add(t);\n        if (run.link) {\n          var rId = this.doc.nextRelationshipId();\n          this.doc.addRelationship(rId, relTypes.hyperlink, run.link, \"External\");\n          r = this.doc.el(\"w:hyperlink\").setAttr(\"r:id\", rId).add(r);\n        }\n        parent.add(r);\n      }\n    },\n    _paragraph: function(parent, paragraph, pStyle, rStyle, pPrs) {\n      var p, pPr;\n      p = this.doc.el(\"w:p\");\n      if (pStyle || rStyle || pPrs) {\n        pPr = this.doc.el(\"w:pPr\");\n        if (pStyle) {\n          pPr.add(pStyle(this.doc.xdoc));\n        }\n        if (rStyle) {\n          pPr.add(this.doc.el(\"w:rPr\").add(rStyle(this.doc.xdoc)));\n        }\n        if (paragraph.hr) {\n          var hr = this.doc.el(\"w:pBdr\");\n          hr.add(this.doc.el(\"w:bottom\").setAttr(\"w:color\", \"auto\").setAttr(\"w:space\", \"1\").setAttr(\"w:sz\", \"6\").setAttr(\"w:val\", \"single\"));\n          pPr.add(hr);\n        }\n        if (pPrs) {\n          pPr.add(pPrs);\n        }\n        p.add(pPr);\n      }\n      this._runs(p, paragraph.runs, rStyle);\n      parent.add(p);\n    },\n    _table: function(parent, table) {\n      var i, j, row, cell, r, c, e, cspan, rspan, cind;\n      var tbl = this.doc.el(\"w:tbl\");\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          c = this.doc.el(\"w:tc\");\n          e = this.doc.el(\"w:tcPr\");\n          if (cspan > 1) {\n            e.add(this.doc.el(\"w:gridSpan\").setAttr(\"w:val\", cspan));\n          }\n          e.add(this.doc.el(\"w:vMerge\"));\n          c.add(e);\n          c.add(this.doc.el(\"w:p\"));\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          r.add(c);\n          cind += cspan;\n        }\n      };\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        r = this.doc.el(\"w:tr\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          c = this.doc.el(\"w:tc\");\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          cell = row.blocks[j];\n          e = this.doc.el(\"w:tcPr\");\n          if (cspan > 1) {\n            e.add(this.doc.el(\"w:gridSpan\").setAttr(\"w:val\", cspan));\n          }\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n            e.add(this.doc.el(\"w:vMerge\").setAttr(\"w:val\", \"restart\"));\n          }\n          c.add(e);\n          this._blocks(c, cell.blocks);\n          r.add(c);\n          cind += cspan;\n        }\n        spanned();\n        tbl.add(r);\n      }\n      parent.add(tbl);\n    }\n  };\n  (function() {\n    for (var f in XPkg.prototype) {\n      if (XPkg.prototype.hasOwnProperty(f)) {\n        DOCXBuilder.prototype[f] = XPkg.prototype[f];\n      }\n    }\n  })();\n  OpenXmlBuilder.DOCXBuilder = DOCXBuilder;\n  if (typeof define === \"function\" && define.amd) {\n    define(function() {\n      return OpenXmlBuilder;\n    });\n  } else if (typeof module === \"object\" && module && typeof module.exports === \"object\" && module.exports) {\n    module.exports = OpenXmlBuilder;\n  } else {\n    window.OpenXmlBuilder = OpenXmlBuilder;\n  }\n})(function() {\n  return this;\n}());"]}