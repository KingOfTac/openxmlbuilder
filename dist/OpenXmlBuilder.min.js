/*!
 * OpenXmlBuilder
 * The OpenXmlBuilder allows you to build simple OpenXml documents right in the browser.
 * Copyright (c) 2015 Jeremy Gore
 * Licensed MIT
 * https://github.com/jmgore75/openxmlbuilder
 * v0.1.1
 */
!function(a,b){"use strict";function c(a){return v[a]||null}function d(a,b){var c={full:a,name:a,ns:b};c.pref=w[b]||"";var d=a.split(":");return 2===d.length&&(c.pref=d[0],c.name=d[1],c.ns=v[c.pref]||null),c.use=c.ns===b?c.name:c.full,c}function e(){var a=B;a+="<"+arguments[0],arguments.length>1&&arguments[1]&&(a+=" xmlns='"+v[arguments[1]]+"'");for(var b=2;b<arguments.length;b++)a+=" xmlns:"+arguments[b]+"='"+v[arguments[b]]+"'";return a+="></"+arguments[0]+">"}function f(a){function b(a){return 10>a?"0"+a:a}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"Z"}function g(a){for(var b=[],c=0;c<a.length;c++)b.push(new h(a[c]));return b}function h(a){this.node=a}function i(a){65279===a.charCodeAt(0)&&(a=a.substring(1)),this.doc=F.makeDoc(a),this.rootNs=this.root().getAttr("xmlns")}function j(a,b,c,d,e){this.xpkg=a,this.path=c,this.contentType=b;var f=c.lastIndexOf("/")+1;if(this.relsPath=c.slice(0,f)+"_rels/"+c.slice(f)+".rels",d)this.xdoc=new i(d),e&&(this.relsXdoc=new i(e));else{var g=this.xpkg.zip.file(this.path.slice(1));g&&(this.xdoc=new i(g.asText()),g=this.xpkg.zip.file(this.relsPath.slice(1)),g&&(this.relsXdoc=new i(g.asText())))}}function k(a,b,c,d){this.zip=new JSZip(a,{base64:!0,checkCRC32:!1}),this.parts={},c=c||new Date,c=f(c),b=b||"Document "+c,d=d||"OpenXmlBuilder",this.ctDoc=new i(this.zip.file("[Content_Types].xml").asText());var e=this.getPart("/docProps/core.xml").xdoc;if(e.one("//dcterms:created").setValue(c),e.one("//dcterms:modified").setValue(c),e.one("//cp:revision").setValue("1"),b){var g=e.one("//dc:title");g?g.setValue(b):e.root().add(e.el("dc:title",b))}e.one("//dc:creator").setValue(d),e.one("//cp:lastModifiedBy").setValue(d)}function l(a,b,c){for(c=c||" ",b=b||2;a.length<b;)a=c+a;return a}function m(a){var b,c=0;if(a=a?a.toString().toUpperCase():"",/^#[A-F0-9]{3,6}$/.test(a)){if(a.length<7){var d=a.split("");a=d[1]+d[1]+d[2]+d[2]+d[3]+d[3]}else a=a.substr(1,8);return a}if(/^[A-Z]+$/.test(a))return H[a]||"";if(a=a.match(/\d+(\.\d+)?%?/g)||[],a.length<3||a.length>4)return"";for(c=0;c<a.length;c++){if(b=a[c],b=-1!==b.indexOf("%")?Math.round(2.55*parseFloat(b)):parseInt(b,10),0>b||b>255)return"";a[c]=l(b.toString(16).toUpperCase(),2,"0")}return 4===a.length&&"00"===a[3]?"":a.slice(0,3).join("")}function n(a){var b={};"super"===a.verticalAlign&&(b.sup=1),"sub"===a.verticalAlign&&(b.sub=1);var c=parseInt(a.fontWeight,10);isNaN(c)?"bold"===a.fontWeight&&(b.b=1):c>=700&&(b.b=1),"italic"===a.fontStyle&&(b.i=1),"underline"===a.textDecoration&&(b.u=1);var d=m(a.color);return d&&"000000"!==d&&(b.color=d),d=m(a.backgroundColor),d&&"FFFFFF"!==d&&(b.bgColor=d),b}function o(){this.blocks=[],this.block=null}function p(a){return a?a.replace(/[\u200B-\u200D\uFEFF]/g,""):void 0}function q(a){var b=document.createElement("DIV"),c=document.head||document.body;c.appendChild(b),b.innerHTML=p(a);var d=new o;return d.procNodes({},b.childNodes),c.removeChild(b),b=null,d.getBlocks()}function r(a,b,c,d){k.call(this,a,b,c,d),this.presentation=this.getPart("/ppt/presentation.xml"),this.sldIdLst=this.presentation.one("/p:presentation/p:sldIdLst"),this.slideCount=this.sldIdLst.all("./p:sldId").length,this.app=this.getPart("/docProps/app.xml").xdoc,this.slidesProp=this.app.one("/ep:Properties/ep:Slides"),this.slidesTitlesProp=this.app.all("/ep:Properties/ep:HeadingPairs/vt:vector/vt:variant/vt:i4"),this.slidesTitlesProp=this.slidesTitlesProp[this.slidesTitlesProp.length-1],this.titlesVector=this.app.one("/ep:Properties/ep:TitlesOfParts/vt:vector"),this.removeAllSlides(),this.slideLayouts=this._findLayouts()}function s(a,b){return function(c){return c.el(a,{"w:val":b})}}function t(a,b,c,d){k.call(this,a,b,c,d),this.doc=this.getPart("/word/document.xml"),this.body=this.doc.one("/w:document/w:body"),this.sectPr=this.body.one("./w:sectPr");for(var e=this.body.all("./*"),f=0;f<e.length;f++)e[f].remove();this.sectPr&&this.body.add(this.sectPr),this.rStyles={},this.pStyles={},this.rStyles.Italic=this.rStyleItalic,this.rStyles.Bold=this.rStyleBold,this.rStyles.Underline=this.rStyleUnderline;var g=this.getPart("/word/styles.xml").all("w:styles/w:style");for(f=0;f<g.length;f++){var h=g[f].getAttr("w:type"),i=g[f].getAttr("w:styleId");"paragraph"===h?this.pStyles[i]=s("w:pStyle",i):"character"===h&&(this.rStyles[i]=s("w:rStyle",i))}this.undoPart("/word/styles.xml")}var u={};u.version="0.1.1";var v={};v.xmlns="http://www.w3.org/2000/xmlns/",v.rel="http://schemas.openxmlformats.org/package/2006/relationships",v.a="http://schemas.openxmlformats.org/drawingml/2006/main",v.p="http://schemas.openxmlformats.org/presentationml/2006/main",v.r="http://schemas.openxmlformats.org/officeDocument/2006/relationships",v.vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",v.dcterms="http://purl.org/dc/terms/",v.dc="http://purl.org/dc/elements/1.1/",v.cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",v.ep="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",v.w="http://schemas.openxmlformats.org/wordprocessingml/2006/main",v.ct="http://schemas.openxmlformats.org/package/2006/content-types";var w={},x="";!function(){for(var a in v)v.hasOwnProperty(a)&&(w[v[a]]=a,x+="xmlns"===a?" xmlns='"+v[a]+"'":" xmlns:"+a+"='"+v[a]+"'")}(),x=x.slice(1);var y={},z="http://schemas.openxmlformats.org/officeDocument/2006/relationships/";y.hyperlink=z+"hyperlink";var A={},B='<?xml version="1.0" encoding="utf-8" standalone="yes"?>',C=e("Relationships","rel"),D={makeDoc:function(a){return(new DOMParser).parseFromString(a,"text/xml")},makeEl:function(a,b,c){var e=d(b,c);return a.createElementNS(e.ns||null,e.use)},toXml:function(a){return(new XMLSerializer).serializeToString(a)},xpath:function(a,b,d){var e=a.ownerDocument||a;if(d)return e.evaluate(b,a,c,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;for(var f=[],g=e.evaluate(b,a,c,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),h=0;h<g.snapshotLength;h++)f.push(g.snapshotItem(h));return f},setNs:function(a,b,c){a.setAttributeNS(v.xmlns,c?"xmlns:"+c:"xmlns",b)}},E={makeDoc:function(b){var c=new a.ActiveXObject("Microsoft.XMLDOM");return c.async="false",c.loadXML(b),c.setProperty("SelectionNamespaces",x),c},makeEl:function(a,b,c){var e=d(b,c);return a.createNode(1,e.use,e.ns||null)},toXml:function(a){return a.xml},xpath:function(a,b,c){return c?a.selectSingleNode(b):a.selectNodes(b)},setNs:function(a,b,c){var d=a.doc.createNode(2,c?"xmlns:"+c:"xmlns",v.xmlns);d.value=b,a.setAttributeNode(d)}},F=a.DOMParser?D:E;u.XMLHelper=F,h.prototype={all:function(a){return g(F.xpath(this.node,a,!1))},one:function(a){var b=F.xpath(this.node,a,!0);return b?new h(b):null},remove:function(){this.node.parentNode.removeChild(this.node)},setValue:function(a){if(1===this.node.nodeType){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);var b=this.node.ownerDocument.createTextNode(a);this.node.appendChild(b)}else 2===this.node.nodeType&&(this.value=a);return this},getValue:function(){return 2===this.node.nodeType?this.value:this.node.nodeValue},setAttr:function(a,b){return this.node.setAttribute(a,b),this},getAttr:function(a){return this.node.getAttribute(a)},removeAttr:function(a){return this.node.removeAttribute(a),this},add:function(a,b){return b?this.node.insertBefore(a.node,b.node):this.node.appendChild(a.node),this},replace:function(a){return this.node.insertBefore(a.node),this.remove(),a}},i.prototype={el:function(a,b,c){var d=new h(F.makeEl(this.doc,a,this.rootNs));if(!c&&b&&"object"!=typeof b&&(c=b,b=null),b)for(var e in b)b.hasOwnProperty(e)&&d.setAttr(e,b[e]);return c&&d.setValue(c),d},root:function(){return new h(this.doc.documentElement)},all:function(a){return g(F.xpath(this.doc,a,!1))},one:function(a){var b=F.xpath(this.doc,a,!0);return b?new h(b):null},nextId:function(a,b,c,d){c=c||0,d=d||"";for(var e={},f=this.all(a),g=0;g<f.length;g++)e[f[g].getAttr(b)]=1;for(;e[d+c];)c+=1;return d+c},setNamespace:function(a,b){F.setNs(this.root(),a,b),b||(this.rootNs=a)},toXmlString:function(){return F.toXml(this.doc)}},j.prototype={nextRelationshipId:function(){return this.relsXdoc?this.relsXdoc.nextId("/rel:Relationships/rel:Relationship","Id",1,"rId"):"rId1"},addRelationship:function(a,b,c,d){this.relsXdoc||(this.relsXdoc=new i(C));var e={Target:c,Type:b,Id:a};d=d||"External","Internal"!==d&&(e.TargetMode=d);var f=this.relsXdoc.el("rel:Relationship",e);this.relsXdoc.root().add(f)},deleteRelationship:function(a){if(this.relsXdoc)for(var b=this.relsXdoc.all("/rel:Relationships/rel:Relationship"),c=0;c<b.length;c++)if(b[c].getAttr("Id")===a)return b[c].remove(),void(1===b.length&&delete this.relsXdoc)},el:function(){return this.xdoc.el.apply(this.xdoc,arguments)},root:function(){return this.xdoc.root()},all:function(){return this.xdoc.all.apply(this.xdoc,arguments)},one:function(){return this.xdoc.one.apply(this.xdoc,arguments)},nextId:function(){return this.xdoc.nextId.apply(this.xdoc,arguments)},setNamespace:function(){return this.xdoc.setNamespace.apply(this.xdoc,arguments)},getRelationshipsByRelationshipType:function(a){return this.relsXdoc.all("/rel:Relationships/rel:Relationship[@Type='"+a+"']")},loadXml:function(a){this.xdoc=new i(a)}},k.prototype={getPart:function(a){if(this.parts.hasOwnProperty(a))return this.parts[a];var b=this.ctDoc.one("/ct:Types/ct:Override[@PartName='"+a+"']"),c=b?new j(this,b.getAttr("ContentType"),a):null;return this.parts[a]=c,c},addPart:function(a,b,c,d){var e=new j(this,a,b,c,d);return this.parts[b]=e,e},addFile:function(a,b,c){this.zip.file(b.slice(1),c);for(var d=this.ctDoc.all("/ct:Types/ct:Override"),e=0;e<d.length;e++)d[e].getAttr("PartName")===b&&d[e].remove();var f=this.ctDoc.el("ct:Override",{ContentType:a,PartName:b});this.ctDoc.root().add(f)},deleteFile:function(a){this.zip.remove(a);for(var b=this.ctDoc.all("/ct:Types/ct:Override"),c=0;c<b.length;c++)b[c].getAttr("PartName")===a&&b[c].remove()},fullPath:function(a,b){if(0===a.indexOf("/"))return a;b=b||"/";var c=b.lastIndexOf("/");for(b=b.slice(0,c+1);0===a.indexOf("../");){if(b=b.slice(0,b.length-1),c=b.lastIndexOf("/"),-1===c)throw"internal error when processing relationships";b=b.slice(0,c+1),a=a.slice(3)}return b+a},undoPart:function(a){delete this.parts[a]},saveChanges:function(){var a;for(var b in this.parts)this.parts.hasOwnProperty(b)&&(a=this.parts[b],a.deleted||!a.xdoc?(this.deleteFile(a.path),this.zip.remove(a.relsPath)):(this.addFile(a.contentType,a.path,a.xdoc.toXmlString()),a.relsXdoc?this.zip.file(a.relsPath.slice(1),a.relsXdoc.toXmlString()):this.zip.remove(a.relsPath)));return this.parts={},this.zip.file("[Content_Types].xml",this.ctDoc.toXmlString()),this.zip},saveToBase64:function(){return this.saveChanges().generate({compression:"deflate",type:"base64"})},saveToBlob:function(){return this.saveChanges().generate({compression:"deflate",type:"blob"})},saveToDataURI:function(){return"data:"+this.mimetype+";base64,"+this.saveToBase64()}};var G=a.getComputedStyle||function(a){return a.currentStyle},H={AQUA:"00FFFF",BLACK:"000000",BLUE:"0000FF",FUCHSIA:"FF00FF",GRAY:"808080",GREEN:"008000",LIME:"00FF00",MAROON:"800000",NAVY:"000080",OLIVE:"808000",PURPLE:"800080",RED:"FF0000",SILVER:"C0C0C0",TEAL:"008080",WHITE:"FFFFFF",YELLOW:"FFFF00"};o.prototype={addRun:function(a,b){var c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);c.text=b;var e=this.currentBlock();return e.runs.push(c),c},currentBlock:function(){return this.block||(this.block={type:"paragraph",runs:[]}),this.block},breakBlock:function(a){if(this.block||a){var b=this.currentBlock();return this.blocks.push(b),this.block=null,b}return this.blocks.length?this.blocks[this.blocks.length-1]:void 0},getBlocks:function(){return this.breakBlock(),this.blocks},procNode:function(a,b){var c;if(3===b.nodeType)/\S/.test(b.nodeValue)&&this.addRun(a,b.nodeValue);else if(1===b.nodeType){var d=G(b);if("none"===d.display)return;var e="block"===d.display,f=n(d);if(e&&this.breakBlock(),"LI"===b.tagName)this.breakBlock(),this.currentBlock().type="list-item",this.procNodes(f,b.childNodes);else if("OL"===b.tagName||"UL"===b.tagName)this.breakBlock(),c=new o,c.procNodes(f,b.childNodes),this.blocks.push({type:"list",listType:b.tagName.toLowerCase(),blocks:c.getBlocks()});else if("TABLE"===b.tagName)c=new o,c.procNodes(f,b.childNodes),this.blocks.push({type:"table",blocks:c.blocks});else if("TR"===b.tagName)c=new o,c.procNodes(f,b.childNodes),this.blocks.push({type:"table-row",blocks:c.blocks});else if("TD"===b.tagName||"TH"===b.tagName)c=new o,c.procNodes(f,b.childNodes),this.blocks.push({type:"table-cell",blocks:c.getBlocks()});else if("A"===b.tagName)f.link=b.href,this.procNodes(f,b.childNodes);else if("HR"===b.tagName)this.currentBlock().hr=!0,this.breakBlock();else if("BR"===b.tagName)this.breakBlock();else if("IMG"===b.tagName){var g=this.addRun(f,"["+(b.alt||b.title||"IMAGE")+"]");g.link=b.src}else this.procNodes(f,b.childNodes)}},procNodes:function(a,b){for(var c=0;c<b.length;c++)this.procNode(a,b[c])}},u.convertHtml=q,y.slideMaster=z+"slideMaster",y.slideLayout=z+"slideLayout",y.slide=z+"slide",A.slide="application/vnd.openxmlformats-officedocument.presentationml.slide+xml",r.prototype={mimetype:"application/vnd.openxmlformats-officedocument.presentationml.presentation",addSlide:function(a,b){b=b||this.slideLayouts["Title and Content"],this.slideCount++;var c=this.slideCount,d=c+255;a=a||"Slide "+c;var e="slides/slide"+c+".xml",f=this.addPart(A.slide,"/ppt/"+e,b.template);f.addRelationship(f.nextRelationshipId(),y.slideLayout,b.relUri,"Internal");var g=this.presentation.nextRelationshipId();return this.presentation.addRelationship(g,y.slide,e,"Internal"),this.sldIdLst.add(this.presentation.el("p:sldId",{"r:id":g,id:d})),this.slidesProp.setValue(c),this.slidesTitlesProp.setValue(c),this.titlesVector.add(this.app.el("vt:lpstr",a)),this.titlesVector.setAttr("size",c+1),f},contentSlide:function(a,b){for(var c=a.title||a["Title 1"],d=this.addSlide(c,b),e=d.all("//p:sp"),f=0;f<e.length;f++){var g=e[f].one("./p:nvSpPr/p:cNvPr").getAttr("name"),h=a[g];if(h){var i=q(h);1===i.length&&"table"===i[0].type?this.pptTable(d,e[f],i[0]):this.pptContent(d,e[f],i)}}},removeAllSlides:function(){for(var a,b,c=this.presentation.getRelationshipsByRelationshipType(y.slide),d=0;d<c.length;d++)a=c[d],b=this.getPart(this.fullPath(a.getAttr("Target"),this.presentation.path)),this.presentation.deleteRelationship(a.relationshipId),b.deleted=!0;this.sldIdLst=this.presentation.one("/p:presentation/p:sldIdLst");var e=this.sldIdLst.all("./p:sldId");for(d=0;d<e.length;d++)e[d].remove();for(this.slidesProp.setValue("0"),this.slidesTitlesProp.setValue("0"),this.titlesVector.setAttr("size","1"),e=this.titlesVector.all("./vt:lpstr"),d=1;d<e.length;d++)e[d].remove();this.slideCount=0},_findLayouts:function(){for(var a={},b=this.zip.folder("ppt/slideLayouts").file(/^slideLayout\d+\.xml$/),c=0;c<b.length;c++){var d=b[c],e=d.name.slice(17),f=parseInt(e.slice(11,-4),10),g="/"+d.name,h="../slideLayouts/"+e,j=new i(d.asText()),k=new i(this.zip.file("ppt/slideLayouts/_rels/"+e+".rels").asText()).one("/rel:Relationships/rel:Relationship[@Type='"+y.slideMaster+"']").getAttr("Target"),l=this.getPart(this.fullPath(k,g)),m=[],n=j.root();n.removeAttr("preserve"),n.removeAttr("type");var o=n.one("p:cSld").getAttr("name");n.one("p:cSld").removeAttr("name");for(var p,q,r=l.one("//p:hf"),s=n.all("//p:sp"),t=0;t<s.length;t++)if(r&&(p=s[t].one("./p:nvSpPr/p:nvPr/p:ph"),p&&(q=p.getAttr("type"),q&&"0"===r.getAttr(q))))s[t].remove();else{var u=s[t].one("./p:nvSpPr/p:cNvPr").getAttr("name");u&&m.push(u)}var v=j.toXmlString();v=v.replace(/(<\/?p:sld)Layout/g,"$1"),a[o]={name:o,index:f,fileName:e,fullUri:g,relUri:h,sections:m,template:v}}return a},_block:function(a,b,c,d,e){"list"===c.type?(d=c.listType||"ul",e=e>=0?e+=1:0,this._blocks(a,b,c.blocks,d,e)):"table"===c.type?this._inlineTable(a,b,c):"list-item"===c.type?this._paragraph(a,b,c,d,e):this._paragraph(a,b,c,null,e)},_blocks:function(a,b,c,d,e){for(var f=0;f<c.length;f++)this._block(a,b,c[f],d,e)},_runs:function(a,b,c){for(var d,e,f,g,h,i,j=0;j<c.length;j++)d=c[j],e=a.el("a:r"),i=d.link,(d.b||d.i||d.u||d.color||d.link)&&(f=a.el("a:rPr"),d.b&&f.setAttr("b","1"),d.i&&f.setAttr("i","1"),d.u&&f.setAttr("u","sng"),d.color&&f.add(a.el("a:solidFill").add(a.el("a:srgbClr",{val:d.color}))),d.link&&(h=a.nextRelationshipId(),a.addRelationship(h,y.hyperlink,d.link,"External"),f.add(a.el("a:hlinkClick",{"r:id":h}))),e.add(f)),g=a.el("a:t",d.text),e.add(g),b.add(e);i&&b.add(a.el("a:endParaRPr").add(a.el("a:hlinkClick",{"r:id":""})))},_paragraph:function(a,b,c,d,e){var f,g;f=a.el("a:p"),(e>=0||"ul"!==d)&&(g=a.el("a:pPr"),f.add(g),e>0&&g.setAttr("lvl",e),"ol"===d?g.add(a.el("a:buAutoNum",{type:"arabicPeriod"})):d||g.add(a.el("a:buNone")),!d&&e>=0&&f.add(a.el("a:r").add(a.el("a:t","	")))),this._runs(a,f,c.runs),b.add(f)},_inlineTable:function(a,b,c,d,e){var f,g,h,i,j,k,l,m={},n=function(){for(;m[h];)i=m[h][1]||1,j=m[h][0],m[h][0]?m[h][0]-=1:delete m[h],h+=i};for(this._paragraph(a,b,{runs:[{u:!0,i:!0,text:"Table"}]},d,e),e=(e||0)+1,f=0;f<c.blocks.length;f++){for(k=c.blocks[f],this._paragraph(a,b,{runs:[{u:!0,i:!0,text:"Row "+(k+1)}]},null,e),h=0,g=0;g<k.blocks.length;g++)n(),l=k.blocks[g],i=l.colspan||1,j=l.rowspan,this._paragraph(a,b,{runs:[{i:!0,text:"Column"+(h+1)}]},null,e+1),this._blocks(a,b,l,null,e+1),j>1&&(m[h]=[j-1,i||1]),h+=i;n()}},_table:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=a.el("a:tbl"),p=function(){return a.el("a:txBody").add(a.el("a:bodyPr")).add(a.el("a:lstStyle"))},q=function(){return a.el("a:tc").add(p().add(a.el("a:p"))).add(a.el("a:tcPr"))},r={},s=function(){for(;r[n];){l=r[n][1]||1,m=r[n][0];var a=q().setAttr("vMerge",1);if(i.add(a),l>1)for(a.setAttr("gridSpan",l),f=1;l>f;f++)i.add(q().setAttr("hMerge",1).setAttr("vMerge",1));r[n][0]?r[n][0]-=1:delete r[n],n+=l}};for(d=0;d<c.blocks.length;d++){for(g=c.blocks[d],i=a.el("a:tr"),n=0,e=0;e<g.blocks.length;e++){if(s(),h=g.blocks[e],l=h.colspan||1,m=h.rowspan,j=a.el("a:tc"),i.add(j),l>1)for(j.setAttr("gridSpan",l),f=1;l>f;f++)i.add(q().setAttr("hMerge",1));m>1&&(r[n]=[m-1,l||1]),k=p(),j.add(k),this._blocks(k,h.blocks),k=a.el("a:tcPr"),j.add(k),n+=l}s(),o.add(i)}b.add(o)},pptContent:function(a,b,c){for(var d=b.one("./p:txBody"),e=d.all("./a:p"),f=0;f<e.length;f++)e[f].remove();this._blocks(a,d,c)},pptLine:function(a,b,c){for(var d=b.one("./p:txBody"),e=d.all("./a:p"),f=0;f<e.length;f++)e[f].remove();if("paragraph"!==c.type)throw"Block is not a paragraph";this._paragraph(a,d,c)},pptTable:function(a,b,c){var d,e,f,g,h=a.el("p:graphicFrame");if(d=a.el("p:nvGraphicFramePr"),h.add(d),e=b.one("./p:cNvPr"),e&&d.add(e),e=b.one("./p:cNvSpPr")){for(f=a.el("p:cNvGraphicFramePr"),e=e.all("./*"),g=0;g<e.length;g++)f.add(e[g]);d.add(f)}if(e=b.one("./p:nvPr"),e&&e.add(e),d=a.el("a:graphic"),h.add(d),e=a.el("a:graphicData").setAttr("uri","http://schemas.openxmlformats.org/drawingml/2006/table"),d.add(e),b.replace(h),"table"!==c.type)throw"Block is not a table";this._table(a,e,c)}},function(){for(var a in k.prototype)k.prototype.hasOwnProperty(a)&&(r.prototype[a]=k.prototype[a])}(),u.PPTXBuilder=r,y.numbering=z+"numbering",y.aFChunk=z+"aFChunk",A.numbering="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",t.prototype={mimetype:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",rStyleItalic:function(a){return a.el("w:i")},rStyleBold:function(a){return a.el("w:b")},rStyleUnderline:s("w:u","single"),rStyleHyperlink:s("w:rStyle","Hyperlink"),pStyleNoSpacing:s("w:pStyle","NoSpacing"),pStyleListParagraph:s("w:pStyle","ListParagraph"),pStyle:function(a){return this.pStyles[a]||s("w:pStyle",a)},rStyle:function(a){return this.rStyles[a]||s("w:rStyle",a)},_levelIndent:function(a){return 720*(1+(a||0))},makeUl:function(){return this.makeList([{fmt:"bullet",fnt:"Symbol",txt:"·"},{fmt:"bullet",fnt:"Courier New",txt:"o"},{fmt:"bullet",fnt:"Wingdings",txt:"§"}],9)},makeOl:function(){return this.makeList([{fmt:"decimal"},{fmt:"lowerLetter"},{fmt:"lowerRoman"}],9)},makeOlNum:function(){return this.makeList([{fmt:"decimal"}],9)},makeOlHier:function(){return this.makeList([{fmt:"decimal",hier:!0}],9)},makeList:function(a,b){var c=this.getPart("/word/numbering.xml");c||(c=this.addPart(A.numbering,"/word/numbering.xml",e("w:numbering",null,"w")),this.doc.addRelationship(this.doc.nextRelationshipId(),y.numbering,"numbering.xml","Internal"));var d=Math.random().toString(16).substring(2,10).toUpperCase(),f=c.nextId("//w:abstractNum","w:abstractNumId",0),g=c.nextId("//w:num","w:numId",1),h=c.el("w:abstractNum").setAttr("w:abstractNumId",f);h.add(c.el("w:nsid").setAttr("w:val",d)),h.add(c.el("w:multiLevelType").setAttr("w:val","hybridMultilevel"));var i,j,k,l,m;b=b||a.length;for(var n=0;b>n;n++)j=a[n%a.length],m=this._levelIndent(n),i=c.el("w:lvl").setAttr("w:ilvl",n),i.add(c.el("w:start").setAttr("w:val","1")),i.add(c.el("w:numFmt").setAttr("w:val",j.fmt)),"bullet"===j.fmt?(k=j.txt||" ",l=""):(k="%"+(n+1)+".",l+=k),i.add(c.el("w:lvlText").setAttr("w:val",j.heir?l:k)),i.add(c.el("w:lvlJc").setAttr("w:val","left")),i.add(c.el("w:pPr").add(c.el("w:ind",{"w:hanging":"360","w:left":m}))),j.fnt&&i.add(c.el("w:rPr").add(c.el("w:rFonts",{"w:hint":"default","w:hAnsi":j.fnt,"w:ascii":j.fnt}))),h.add(i);var o=c.el("w:num").setAttr("w:numId",g);return o.add(c.el("w:abstractNumId").setAttr("w:val",f)),c.xdoc.root().add(h),c.xdoc.root().add(o),g},docLine:function(a,b,c){var d=q(a);if(1!==d.length||"paragraph"!==d[0].type)throw"Content is too complex";d=d[0],this._paragraph(this.body,this.sectPr,d,b,c)},docContent:function(a){var b=q(a);this._blocks(this.body,this.sectPr,b)},docChunk:function(a){a="<html><head></head><body>"+p(a)+"</body></html>";var b=this.doc.nextRelationshipId(),c="/word/chunk"+b+".html";this.addFile("text/html",c,a),this.doc.addRelationship(b,y.aFChunk,c,"Internal");var d=this.doc.el("w:altChunk").setAttr("r:id",b);this.body.add(d,this.sectPr)},_block:function(a,b,c,d,e){var f;"table"===c.type?this._table(a,b,c):"list"===c.type?(d?e+=1:(d="ul"===c.listType?this.makeUl():this.makeOlHier(),e=0),this._blocks(a,b,c.blocks,d,e)):"list-item"===c.type&&d?(f=this.doc.el("w:numPr"),f.add(s("w:ilvl",e)(this.doc.xdoc)),f.add(s("w:numId",d)(this.doc.xdoc)),this._paragraph(a,b,c,null,null,f)):d?(f=this.doc.el("w:ind").setAttr("w:left",this._levelIndent(e)),this._paragraph(a,b,c,this.pStyleListParagraph,null,f)):this._paragraph(a,b,c)},_blocks:function(a,b,c,d,e){for(var f=0;f<c.length;f++)this._block(a,b,c[f],d,e)},_runs:function(a,b,c){for(var d,e,f,g,h=0;h<b.length;h++){if(d=b[h],e=this.doc.el("w:r"),(d.b||d.i||d.u||d.color||d.link||c)&&(f=this.doc.el("w:rPr"),d.link&&(c?f.add(this.rStyleUnderline(this.doc.xdoc)):f.add(this.rStyleHyperlink(this.doc.xdoc))),c&&f.add(c(this.doc.xdoc)),d.b&&f.add(this.rStyleBold(this.doc.xdoc)),d.i&&f.add(this.rStyleItalic(this.doc.xdoc)),d.u&&f.add(this.rStyleUnderline(this.doc.xdoc)),d.color&&f.add(s("w:color",d.color)(this.doc.xdoc)),e.add(f)),g=this.doc.el("w:t",d.text),/^\s+|\s+$/.test(d.text)&&g.setAttr("xml:space","preserve"),e.add(g),d.link){var i=this.doc.nextRelationshipId();this.doc.addRelationship(i,y.hyperlink,d.link,"External"),e=this.doc.el("w:hyperlink").setAttr("r:id",i).add(e)}a.add(e)}},_paragraph:function(a,b,c,d,e,f){var g,h;if(g=this.doc.el("w:p"),d||e||f){if(h=this.doc.el("w:pPr"),d&&h.add(d(this.doc.xdoc)),e&&h.add(this.doc.el("w:rPr").add(e(this.doc.xdoc))),c.hr){var i=this.doc.el("w:pBdr");i.add(this.doc.el("w:bottom").setAttr("w:color","auto").setAttr("w:space","1").setAttr("w:sz","6").setAttr("w:val","single")),h.add(i)}f&&h.add(f),g.add(h)}this._runs(g,c.runs,e),a.add(g,b)},_table:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this.doc.el("w:tbl"),o={},p=function(){for(;o[m];)k=o[m][1]||1,l=o[m][0],i=this.doc.el("w:tc"),j=this.doc.el("w:tcPr"),k>1&&j.add(this.doc.el("w:gridSpan").setAttr("w:val",k)),j.add(this.doc.el("w:vMerge")),i.add(j),i.add(this.doc.el("w:p")),o[m][0]?o[m][0]-=1:delete o[m],h.add(i),m+=k};for(d=0;d<c.blocks.length;d++){for(f=c.blocks[d],h=this.doc.el("w:tr"),m=0,e=0;e<f.blocks.length;e++)p(),i=this.doc.el("w:tc"),k=g.colspan||1,l=g.rowspan,g=f.blocks[e],j=this.doc.el("w:tcPr"),k>1&&j.add(this.doc.el("w:gridSpan").setAttr("w:val",k)),l>1&&(o[m]=[l-1,k||1],j.add(this.doc.el("w:vMerge").setAttr("w:val","restart"))),i.add(j),this._blocks(i,g.blocks),h.add(i),m+=k;p(),n.add(h)}a.add(n,b)}},function(){for(var a in k.prototype)k.prototype.hasOwnProperty(a)&&(t.prototype[a]=k.prototype[a])}(),u.DOCXBuilder=t,"function"==typeof define&&define.amd?define(function(){return u}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=u:a.OpenXmlBuilder=u}(function(){return this}());
//# sourceMappingURL=OpenXmlBuilder.min.map